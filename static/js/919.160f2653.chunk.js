"use strict";(self.webpackChunkplaain=self.webpackChunkplaain||[]).push([[919],{886:function(e,t,n){n.d(t,{KU:function(){return le}});var r=n(181);function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}var a=n(5671),o=n(3144),s=n(7757),u=n.n(s);function c(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}Object.create;var d;Object.create;!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(d||(d={})),(function(){function e(t){if((0,a.Z)(this,e),this.requests=new Map,"undefined"!==typeof t){var n=e.requestLimit;if(t.length>n){var r=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(n));throw r.name="Limit Exceeded Error",r}var o,s=i(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.addRequest(u)}}catch(c){s.e(c)}finally{s.f()}}}return(0,o.Z)(e,[{key:"addRequest",value:function(t){var n=e.requestLimit;if(""===t.id){var r=new Error("Id for a request is empty, Please provide an unique id");throw r.name="Empty Id For Request",r}if(this.requests.size===n){var i=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(n));throw i.name="Limit Exceeded Error",i}if(this.requests.has(t.id)){var a=new Error("Adding request with duplicate id ".concat(t.id,", Make the id of the requests unique"));throw a.name="Duplicate RequestId Error",a}return this.requests.set(t.id,t),t.id}},{key:"removeRequest",value:function(e){for(var t=this.requests.delete(e),n=this.requests.entries(),r=n.next();!r.done;){var i=r.value[1].dependsOn;if("undefined"!==typeof i){var a=i.indexOf(e);-1!==a&&i.splice(a,1),0===i.length&&delete r.value[1].dependsOn}r=n.next()}return t}},{key:"getContent",value:function(){return c(this,void 0,void 0,u().mark((function t(){var n,r,i,a,o,s,c,d,l;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r={requests:n=[]},i=this.requests.entries(),!(a=i.next()).done){t.next=8;break}throw(o=new Error("No requests added yet, Please add at least one request.")).name="Empty Payload",o;case 8:if(e.validateDependencies(this.requests)){t.next=12;break}throw(s=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.")).name="Invalid Dependency",s;case 12:if(a.done){t.next=27;break}return c=a.value[1],t.next=16,e.getRequestData(c.request);case 16:if(void 0===(d=t.sent).body||void 0!==d.headers&&void 0!==d.headers["content-type"]){t.next=21;break}throw(l=new Error("Content-type header is not mentioned for request #".concat(c.id,", For request having body, Content-type header should be mentioned"))).name="Invalid Content-type header",l;case 21:d.id=c.id,void 0!==c.dependsOn&&c.dependsOn.length>0&&(d.dependsOn=c.dependsOn),n.push(d),a=i.next(),t.next=12;break;case 27:return r.requests=n,t.abrupt("return",r);case 29:case"end":return t.stop()}}),t,this)})))}},{key:"addDependency",value:function(e,t){if(!this.requests.has(e)){var n=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw n.name="Invalid Dependent",n}if("undefined"!==typeof t&&!this.requests.has(t)){var r=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw r.name="Invalid Dependency",r}if("undefined"!==typeof t){var i=this.requests.get(e);if(void 0===i.dependsOn&&(i.dependsOn=[]),-1!==i.dependsOn.indexOf(t)){var a=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw a.name="Duplicate Dependency",a}i.dependsOn.push(t)}else{for(var o,s=this.requests.entries(),u=s.next();!u.done&&u.value[1].id!==e;)o=u,u=s.next();if("undefined"===typeof o){var c=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw c.name="Invalid Dependency Addition",c}var d=o.value[0];if(void 0===u.value[1].dependsOn&&(u.value[1].dependsOn=[]),-1!==u.value[1].dependsOn.indexOf(d)){var l=new Error("Dependency ".concat(d," is already added for the request ").concat(e));throw l.name="Duplicate Dependency",l}u.value[1].dependsOn.push(d)}}},{key:"removeDependency",value:function(e,t){var n=this.requests.get(e);if("undefined"===typeof n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if("undefined"!==typeof t){var r=n.dependsOn.indexOf(t);return-1!==r&&(n.dependsOn.splice(r,1),!0)}return delete n.dependsOn,!0}}],[{key:"validateDependencies",value:function(e){if(0===e.size){var t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return function(e){for(var t=e.entries(),n=t.next();!n.done;){var r=n.value[1];if(void 0!==r.dependsOn&&r.dependsOn.length>0)return!1;n=t.next()}return!0}(e)||function(e){var t=e.entries(),n=t.next(),r=n.value[1];if(void 0!==r.dependsOn&&r.dependsOn.length>0)return!1;var i=n;for(n=t.next();!n.done;){var a=n.value[1];if(void 0===a.dependsOn||1!==a.dependsOn.length||a.dependsOn[0]!==i.value[1].id)return!1;i=n,n=t.next()}return!0}(e)||function(e){var t,n=e.entries(),r=n.next(),i=r.value[1];if(void 0===i.dependsOn||0===i.dependsOn.length)t=i.id;else{if(1!==i.dependsOn.length)return!1;var a=i.dependsOn[0];if(a===i.id||!e.has(a))return!1;t=a}for(r=n.next();!r.done;){var o=r.value[1];if((void 0===o.dependsOn||0===o.dependsOn.length)&&t!==o.id)return!1;if(void 0!==o.dependsOn&&0!==o.dependsOn.length){if(1===o.dependsOn.length&&(o.id===t||o.dependsOn[0]!==t))return!1;if(o.dependsOn.length>1)return!1}r=n.next()}return!0}(e)}},{key:"getRequestData",value:function(t){return c(this,void 0,void 0,u().mark((function n(){var r,i,a;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r={url:""},i=new RegExp("^https?://"),r.url=i.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,r.method=t.method,a={},t.headers.forEach((function(e,t){a[t]=e})),Object.keys(a).length&&(r.headers=a),t.method!==d.PATCH&&t.method!==d.POST&&t.method!==d.PUT){n.next=11;break}return n.next=10,e.getRequestBody(t);case 10:r.body=n.sent;case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}}),n)})))}},{key:"getRequestBody",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n,r,i,a,o,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!1,t.prev=1,i=e.clone(),t.next=5,i.json();case 5:r=t.sent,n=!0,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:if(n){t.next=33;break}if(t.prev=12,"undefined"===typeof Blob){t.next=23;break}return t.next=16,e.blob();case 16:return a=t.sent,o=new FileReader,t.next=20,new Promise((function(e){o.addEventListener("load",(function(){var t=o.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])}),!1),o.readAsDataURL(a)}));case 20:r=t.sent,t.next=28;break;case 23:if("undefined"===typeof Buffer){t.next=28;break}return t.next=26,e.buffer();case 26:s=t.sent,r=s.toString("base64");case 28:n=!0,t.next=33;break;case 31:t.prev=31,t.t1=t.catch(12);case 33:return t.abrupt("return",r);case 34:case"end":return t.stop()}}),t,null,[[1,9],[12,31]])})))}}]),e}()).requestLimit=20;var l,f=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]),h=n(7326),p=n(136),v=n(9388),y=n(8664),m=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e){var r;return(0,a.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,h.Z)(r),n.prototype),r}return(0,o.Z)(n,null,[{key:"setGraphClientError",value:function(e){var t;return e instanceof Error?t=e:(t=new n).customError=e,t}}]),n}((0,y.Z)(Error)),x=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],w=function(e){var t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"===typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(n){throw new Error("Unable to stringify the content")}return e},E=function(e){return b(e)},g=function(e,t){return t.forEach((function(e){return k(e)})),b(e,t)},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;if(-1!==(e=e.toLowerCase()).indexOf("https://")){var n=(e=e.replace("https://","")).indexOf(":"),r=e.indexOf("/"),i="";if(-1!==r)return-1!==n&&n<r?(i=e.substring(0,n),t.has(i)):(i=e.substring(0,r),t.has(i))}return!1},k=function(e){if(-1!==e.indexOf("/"))throw new m("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")},R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,a.Z)(this,e),this.middlewareOptions=new Map;var n,r=i(t);try{for(r.s();!(n=r.n()).done;){var o=n.value,s=o.constructor;this.middlewareOptions.set(s,o)}}catch(u){r.e(u)}finally{r.f()}}return(0,o.Z)(e,[{key:"getMiddlewareOptions",value:function(e){return this.middlewareOptions.get(e)}},{key:"setMiddlewareOptions",value:function(e,t){this.middlewareOptions.set(e,t)}}]),e}(),A=n(4942),O=function(){for(var e="",t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},T=function(e,t,n){var r=null;if("undefined"!==typeof Request&&e instanceof Request)r=e.headers.get(n);else if("undefined"!==typeof t&&void 0!==t.headers)if("undefined"!==typeof Headers&&t.headers instanceof Headers)r=t.headers.get(n);else if(t.headers instanceof Array){for(var i=t.headers,a=0,o=i.length;a<o;a++)if(i[a][0]===n){r=i[a][1];break}}else void 0!==t.headers[n]&&(r=t.headers[n]);return r},D=function(e,t,n,r){if("undefined"!==typeof Request&&e instanceof Request)e.headers.set(n,r);else if("undefined"!==typeof t)if(void 0===t.headers)t.headers=new Headers((0,A.Z)({},n,r));else if("undefined"!==typeof Headers&&t.headers instanceof Headers)t.headers.set(n,r);else if(t.headers instanceof Array){for(var i=0,a=t.headers.length;i<a;i++){var o=t.headers[i];if(o[0]===n){o[1]=r;break}}i===a&&t.headers.push([n,r])}else Object.assign(t.headers,(0,A.Z)({},n,r))},_=function(e,t,n,r){"undefined"!==typeof Request&&e instanceof Request?e.headers.append(n,r):"undefined"!==typeof t&&(void 0===t.headers?t.headers=new Headers((0,A.Z)({},n,r)):"undefined"!==typeof Headers&&t.headers instanceof Headers?t.headers.append(n,r):t.headers instanceof Array?t.headers.push([n,r]):void 0===t.headers?t.headers=(0,A.Z)({},n,r):void 0===t.headers[n]?t.headers[n]=r:t.headers[n]+=", ".concat(r))},P=function(e,t){return c(void 0,void 0,void 0,u().mark((function n(){var r,i,a,o,s,c,d,l,f,h,p,v;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.headers.get("Content-Type")){n.next=6;break}return n.next=3,t.blob();case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,Promise.resolve(void 0);case 8:n.t0=n.sent;case 9:return r=n.t0,i=t.method,a=t.headers,o=t.referrer,s=t.referrerPolicy,c=t.mode,d=t.credentials,l=t.cache,f=t.redirect,h=t.integrity,p=t.keepalive,v=t.signal,n.abrupt("return",new Request(e,{method:i,headers:a,body:r,referrer:o,referrerPolicy:s,mode:c,credentials:d,cache:l,redirect:f,integrity:h,keepalive:p,signal:v}));case 12:case"end":return n.stop()}}),n)})))},C=(0,o.Z)((function e(t,n){(0,a.Z)(this,e),this.authenticationProvider=t,this.authenticationProviderOptions=n}));!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(l||(l={}));var S=function(){function e(){(0,a.Z)(this,e),this.featureUsage=l.NONE}return(0,o.Z)(e,[{key:"setFeatureUsage",value:function(e){this.featureUsage=this.featureUsage|e}},{key:"getFeatureUsage",value:function(){return this.featureUsage.toString(16)}}],[{key:"updateFeatureUsageFlag",value:function(t,n){var r;t.middlewareControl instanceof R?r=t.middlewareControl.getMiddlewareOptions(e):t.middlewareControl=new R,"undefined"===typeof r&&(r=new e,t.middlewareControl.setMiddlewareOptions(e,r)),r.setFeatureUsage(n)}}]),e}(),U=function(){function e(t){(0,a.Z)(this,e),this.authenticationProvider=t}return(0,o.Z)(e,[{key:"execute",value:function(t){return c(this,void 0,void 0,u().mark((function n(){var r,i,a,o,s,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="string"===typeof t.request?t.request:t.request.url,!(E(r)||t.customHosts&&g(r,t.customHosts))){n.next=13;break}return t.middlewareControl instanceof R&&(i=t.middlewareControl.getMiddlewareOptions(C)),i&&(a=i.authenticationProvider,o=i.authenticationProviderOptions),a||(a=this.authenticationProvider),n.next=7,a.getAccessToken(o);case 7:s=n.sent,c="Bearer ".concat(s),_(t.request,t.options,e.AUTHORIZATION_HEADER,c),S.updateFeatureUsageFlag(t,l.AUTHENTICATION_HANDLER_ENABLED),n.next=14;break;case 13:t.options.headers&&delete t.options.headers[e.AUTHORIZATION_HEADER];case 14:return n.next=16,this.nextMiddleware.execute(t);case 16:return n.abrupt("return",n.sent);case 17:case"end":return n.stop()}}),n,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();U.AUTHORIZATION_HEADER="Authorization";var L=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,[{key:"execute",value:function(e){return c(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.request,e.options);case 2:e.response=t.sent;case 3:case"end":return t.stop()}}),t)})))}}]),e}(),M=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_DELAY,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAX_RETRIES,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultShouldRetry;if((0,a.Z)(this,e),t>e.MAX_DELAY&&n>e.MAX_MAX_RETRIES){var i=new Error("Delay and MaxRetries should not be more than ".concat(e.MAX_DELAY," and ").concat(e.MAX_MAX_RETRIES));throw i.name="MaxLimitExceeded",i}if(t>e.MAX_DELAY){var o=new Error("Delay should not be more than ".concat(e.MAX_DELAY));throw o.name="MaxLimitExceeded",o}if(n>e.MAX_MAX_RETRIES){var s=new Error("MaxRetries should not be more than ".concat(e.MAX_MAX_RETRIES));throw s.name="MaxLimitExceeded",s}if(t<0&&n<0){var u=new Error("Delay and MaxRetries should not be negative");throw u.name="MinExpectationNotMet",u}if(t<0){var c=new Error("Delay should not be negative");throw c.name="MinExpectationNotMet",c}if(n<0){var d=new Error("MaxRetries should not be negative");throw d.name="MinExpectationNotMet",d}this.delay=Math.min(t,e.MAX_DELAY),this.maxRetries=Math.min(n,e.MAX_MAX_RETRIES),this.shouldRetry=r}return(0,o.Z)(e,[{key:"getMaxDelay",value:function(){return e.MAX_DELAY}}]),e}();M.DEFAULT_DELAY=3,M.DEFAULT_MAX_RETRIES=3,M.MAX_DELAY=180,M.MAX_MAX_RETRIES=10,M.defaultShouldRetry=function(){return!0};var N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new M;(0,a.Z)(this,e),this.options=t}return(0,o.Z)(e,[{key:"isRetry",value:function(t){return-1!==e.RETRY_STATUS_CODES.indexOf(t.status)}},{key:"isBuffered",value:function(e,t){var n="string"===typeof e?t.method:e.method;if((n===d.PUT||n===d.PATCH||n===d.POST)&&"application/octet-stream"===T(e,t,"Content-Type"))return!1;return!0}},{key:"getDelay",value:function(t,n,r){var i,a=function(){return Number(Math.random().toFixed(3))},o=void 0!==t.headers?t.headers.get(e.RETRY_AFTER_HEADER):null;return i=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):n>=2?this.getExponentialBackOffTime(n)+r+a():r+a(),Math.min(i,this.options.getMaxDelay()+a())}},{key:"getExponentialBackOffTime",value:function(e){return Math.round(.5*(Math.pow(2,e)-1))}},{key:"sleep",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=1e3*e,t.abrupt("return",new Promise((function(e){return setTimeout(e,n)})));case 2:case"end":return t.stop()}}),t)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof R&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),"undefined"===typeof t&&(t=Object.assign(new M,this.options)),t}},{key:"executeWithRetry",value:function(t,n,r){return c(this,void 0,void 0,u().mark((function i(){var a;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.nextMiddleware.execute(t);case 2:if(!(n<r.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&r.shouldRetry(r.delay,n,t.request,t.options,t.response))){i.next=13;break}return++n,D(t.request,t.options,e.RETRY_ATTEMPT_HEADER,n.toString()),a=this.getDelay(t.response,n,r.delay),i.next=8,this.sleep(a);case 8:return i.next=10,this.executeWithRetry(t,n,r);case 10:return i.abrupt("return",i.sent);case 13:return i.abrupt("return");case 14:case"end":return i.stop()}}),i,this)})))}},{key:"execute",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 0,n=this.getOptions(e),S.updateFeatureUsageFlag(e,l.RETRY_HANDLER_ENABLED),t.next=5,this.executeWithRetry(e,0,n);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();N.RETRY_STATUS_CODES=[429,503,504],N.RETRY_ATTEMPT_HEADER="Retry-Attempt",N.RETRY_AFTER_HEADER="Retry-After";var I=(0,o.Z)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_MAX_REDIRECTS,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultShouldRedirect;if((0,a.Z)(this,e),t>e.MAX_MAX_REDIRECTS){var r=new Error("MaxRedirects should not be more than ".concat(e.MAX_MAX_REDIRECTS));throw r.name="MaxLimitExceeded",r}if(t<0){var i=new Error("MaxRedirects should not be negative");throw i.name="MinExpectationNotMet",i}this.maxRedirects=t,this.shouldRedirect=n}));I.DEFAULT_MAX_REDIRECTS=5,I.MAX_MAX_REDIRECTS=20,I.defaultShouldRedirect=function(){return!0};var q=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new I;(0,a.Z)(this,e),this.options=t}return(0,o.Z)(e,[{key:"isRedirect",value:function(t){return-1!==e.REDIRECT_STATUS_CODES.indexOf(t.status)}},{key:"hasLocationHeader",value:function(t){return t.headers.has(e.LOCATION_HEADER)}},{key:"getLocationHeader",value:function(t){return t.headers.get(e.LOCATION_HEADER)}},{key:"isRelativeURL",value:function(e){return-1===e.indexOf("://")}},{key:"shouldDropAuthorizationHeader",value:function(e,t){var n,r,i=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,a=i.exec(e);null!==a&&(n=a[0]);var o=i.exec(t);return null!==o&&(r=o[0]),"undefined"!==typeof n&&"undefined"!==typeof r&&n!==r}},{key:"updateRequestUrl",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("string"!==typeof t.request){n.next=4;break}n.t0=e,n.next=7;break;case 4:return n.next=6,P(e,t.request);case 6:n.t0=n.sent;case 7:t.request=n.t0;case 8:case"end":return n.stop()}}),n)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof R&&(t=e.middlewareControl.getMiddlewareOptions(I)),"undefined"===typeof t&&(t=Object.assign(new I,this.options)),t}},{key:"executeWithRedirect",value:function(t,n,r){return c(this,void 0,void 0,u().mark((function i(){var a,o;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.nextMiddleware.execute(t);case 2:if(a=t.response,!(n<r.maxRedirects&&this.isRedirect(a)&&this.hasLocationHeader(a)&&r.shouldRedirect(a))){i.next=18;break}if(++n,a.status!==e.STATUS_CODE_SEE_OTHER){i.next=10;break}t.options.method=d.GET,delete t.options.body,i.next=14;break;case 10:return o=this.getLocationHeader(a),!this.isRelativeURL(o)&&this.shouldDropAuthorizationHeader(a.url,o)&&delete t.options.headers[e.AUTHORIZATION_HEADER],i.next=14,this.updateRequestUrl(o,t);case 14:return i.next=16,this.executeWithRedirect(t,n,r);case 16:i.next=19;break;case 18:return i.abrupt("return");case 19:case"end":return i.stop()}}),i,this)})))}},{key:"execute",value:function(t){return c(this,void 0,void 0,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return 0,r=this.getOptions(t),t.options.redirect=e.MANUAL_REDIRECT,S.updateFeatureUsageFlag(t,l.REDIRECT_HANDLER_ENABLED),n.next=6,this.executeWithRedirect(t,0,r);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();q.REDIRECT_STATUS_CODES=[301,302,303,307,308],q.STATUS_CODE_SEE_OTHER=303,q.LOCATION_HEADER="Location",q.AUTHORIZATION_HEADER="Authorization",q.MANUAL_REDIRECT="manual";var F=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,[{key:"execute",value:function(t){return c(this,void 0,void 0,u().mark((function n(){var r,i,a,o,s;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="string"===typeof t.request?t.request:t.request.url,E(r)||t.customHosts&&g(r,t.customHosts)?((i=T(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER))||(i=O(),D(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER,i)),a="".concat(e.PRODUCT_NAME,"/").concat("3.0.1"),t.middlewareControl instanceof R&&(o=t.middlewareControl.getMiddlewareOptions(S)),o&&(s=o.getFeatureUsage(),a+=" (".concat(e.FEATURE_USAGE_STRING,"=").concat(s,")")),_(t.request,t.options,e.SDK_VERSION_HEADER,a)):(delete t.options.headers[e.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[e.SDK_VERSION_HEADER]),n.next=4,this.nextMiddleware.execute(t);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();F.CLIENT_REQUEST_ID_HEADER="client-request-id",F.SDK_VERSION_HEADER="SdkVersion",F.PRODUCT_NAME="graph-js",F.FEATURE_USAGE_STRING="featureUsage";var Z;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(Z||(Z={}));var H,j,B,Q;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(H||(H={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(j||(j={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(B||(B={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(Q||(Q={}));var X=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"parseDocumentResponse",value:function(e,t){return"undefined"!==typeof DOMParser?new Promise((function(n,r){e.text().then((function(e){try{var i=(new DOMParser).parseFromString(e,t);n(i)}catch(a){r(a)}}))})):Promise.resolve(e.body)}},{key:"convertResponse",value:function(t,n){return c(this,void 0,void 0,u().mark((function r(){var i,a,o;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(204!==t.status){r.next=2;break}return r.abrupt("return",Promise.resolve());case 2:a=t.headers.get("Content-type"),r.t0=n,r.next=r.t0===H.ARRAYBUFFER?6:r.t0===H.BLOB?10:r.t0===H.DOCUMENT?14:r.t0===H.JSON?18:r.t0===H.STREAM?22:r.t0===H.TEXT?26:30;break;case 6:return r.next=8,t.arrayBuffer();case 8:return i=r.sent,r.abrupt("break",59);case 10:return r.next=12,t.blob();case 12:return i=r.sent,r.abrupt("break",59);case 14:return r.next=16,e.parseDocumentResponse(t,j.TEXT_XML);case 16:return i=r.sent,r.abrupt("break",59);case 18:return r.next=20,t.json();case 20:return i=r.sent,r.abrupt("break",59);case 22:return r.next=24,Promise.resolve(t.body);case 24:return i=r.sent,r.abrupt("break",59);case 26:return r.next=28,t.text();case 28:return i=r.sent,r.abrupt("break",59);case 30:if(null===a){r.next=57;break}if(o=a.split(";")[0],!new RegExp(Q.DOCUMENT).test(o)){r.next=38;break}return r.next=35,e.parseDocumentResponse(t,o);case 35:i=r.sent,r.next=55;break;case 38:if(!new RegExp(Q.IMAGE).test(o)){r.next=42;break}i=t.blob(),r.next=55;break;case 42:if(o!==B.TEXT_PLAIN){r.next=48;break}return r.next=45,t.text();case 45:i=r.sent,r.next=55;break;case 48:if(o!==B.APPLICATION_JSON){r.next=54;break}return r.next=51,t.json();case 51:i=r.sent,r.next=55;break;case 54:i=Promise.resolve(t.body);case 55:r.next=58;break;case 57:i=Promise.resolve(t.body);case 58:return r.abrupt("break",59);case 59:return r.abrupt("return",i);case 60:case"end":return r.stop()}}),r)})))}},{key:"getResponse",value:function(t,n,r){return c(this,void 0,void 0,u().mark((function i(){var a;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n!==H.RAW){i.next=4;break}return i.abrupt("return",Promise.resolve(t));case 4:return i.next=6,e.convertResponse(t,n);case 6:if(a=i.sent,!t.ok){i.next=15;break}if("function"!==typeof r){i.next=12;break}r(null,a),i.next=13;break;case 12:return i.abrupt("return",a);case 13:i.next=16;break;case 15:throw a;case 16:case"end":return i.stop()}}),i)})))}}]),e}(),z=(0,o.Z)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;(0,a.Z)(this,e),this.minValue=t,this.maxValue=n})),V=function(){function e(t,n){(0,a.Z)(this,e),this._location=n,this._responseBody=t}return(0,o.Z)(e,[{key:"location",get:function(){return this._location},set:function(e){this._location=e}},{key:"responseBody",get:function(){return this._responseBody},set:function(e){this._responseBody=e}}],[{key:"CreateUploadResult",value:function(t,n){return new e(t,n.get("location"))}}]),e}(),$=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if((0,a.Z)(this,e),this.DEFAULT_FILE_SIZE=5242880,this.client=t,!n.sliceFile)throw new m("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=n,this.file=n,i.rangeSize||(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=r,this.nextRange=new z(0,this.options.rangeSize-1)}return(0,o.Z)(e,[{key:"parseRange",value:function(e){var t=e[0];if("undefined"===typeof t||""===t)return new z;var n=t.split("-"),r=parseInt(n[0],10),i=parseInt(n[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new z(r,i)}},{key:"updateTaskStatus",value:function(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}},{key:"getNextRange",value:function(){if(-1===this.nextRange.minValue)return this.nextRange;var e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new z(e,t)}},{key:"sliceFile",value:function(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Buffer)return this.file.content.slice(e.minValue,e.maxValue+1);throw new m("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Buffer file content. Please note that the sliceFile() function is deprecated.")}},{key:"upload",value:function(){return c(this,void 0,void 0,u().mark((function e(){var t,n,r,i,a,o,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.options&&this.options.uploadEventHandlers;case 1:if(this.uploadSession.isCancelled){e.next=26;break}if(-1!==(n=this.getNextRange()).maxValue){e.next=7;break}throw(r=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file")).name="Invalid Session",r;case 7:return e.next=9,this.file.sliceFile(n);case 9:return i=e.sent,e.next=12,this.uploadSliceGetRawResponse(i,n,this.file.size);case 12:if(a=e.sent){e.next=15;break}throw new m("Something went wrong! Large file upload slice response is null.");case 15:return e.next=17,X.getResponse(a);case 17:if(o=e.sent,!(201===a.status||200===a.status&&o.id)){e.next=21;break}return s=V.CreateUploadResult(o,a.headers),e.abrupt("return",s);case 21:c={expirationDateTime:o.expirationDateTime||o.ExpirationDateTime,nextExpectedRanges:o.NextExpectedRanges||o.nextExpectedRanges},this.updateTaskStatus(c),t&&t.progress&&t.progress(n,t.extraCallbackParam),e.next=1;break;case 26:case"end":return e.stop()}}),e,this)})))}},{key:"uploadSlice",value:function(e,t,n){return c(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(n),"Content-Type":"application/octet-stream"}).put(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"uploadSliceGetRawResponse",value:function(e,t,n){return c(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(n),"Content-Type":"application/octet-stream"}).responseType(H.RAW).put(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"cancel",value:function(){return c(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.api(this.uploadSession.url).responseType(H.RAW).delete();case 2:return 204===(t=e.sent).status&&(this.uploadSession.isCancelled=!0),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getStatus",value:function(){return c(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.api(this.uploadSession.url).get();case 2:return t=e.sent,this.updateTaskStatus(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"resume",value:function(){return c(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getStatus();case 2:return e.next=4,this.upload();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getUploadSession",value:function(){return this.uploadSession}}],[{key:"createUploadSession",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return c(this,void 0,void 0,u().mark((function i(){var a,o;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.api(t).headers(r).post(n);case 2:return a=i.sent,o={url:a.uploadUrl,expiry:new Date(a.expirationDateTime),isCancelled:!1},i.abrupt("return",o);case 5:case"end":return i.stop()}}),i)})))}}]),e}(),W=n(1120);function Y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,W.Z)(e)););return e}function G(){return G="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Y(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},G.apply(this,arguments)}var J=function(){function e(t,n,r){if((0,a.Z)(this,e),this.content=t,this.name=n,this.size=r,!t||!n||!r)throw new m("Please provide the upload content, name of the file and size of the file")}return(0,o.Z)(e,[{key:"sliceFile",value:function(e){return this.content.slice(e.minValue,e.maxValue+1)}}]),e}(),K=5242880,ee=function(e){return e>327680&&(e=320*Math.floor(e/327680)*1024),e},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=62914560;return e>t&&(e=t),ee(e)},ne=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(e,r,i,o){return(0,a.Z)(this,n),t.call(this,e,r,i,o)}return(0,o.Z)(n,[{key:"commit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rename";return c(this,void 0,void 0,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url},n.next=3,this.client.api(e).put(r);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n,this)})))}}],[{key:"constructCreateSessionUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_UPLOAD_PATH;return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t="/".concat(t)),"/"!==t[t.length-1]&&(t="".concat(t,"/")),"/me/drive/root:".concat(t.split("/").map((function(e){return encodeURIComponent(e)})).join("/")).concat(encodeURIComponent(e),":/createUploadSession")}},{key:"getFileInfo",value:function(e,t){var n,r;if("undefined"!==typeof Blob&&e instanceof Blob)r=(n=new File([e],t)).size;else if("undefined"!==typeof File&&e instanceof File)r=(n=e).size;else if("undefined"!==typeof Buffer&&e instanceof Buffer){var i=e;r=i.byteLength,n=i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength)}return{content:n,size:r}}},{key:"create",value:function(e,t,r){return c(this,void 0,void 0,u().mark((function i(){var a,o,s;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e&&t&&r){i.next=2;break}throw new m("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");case 2:return a=r.fileName,o=n.getFileInfo(t,a),s=new J(o.content,a,o.size),i.abrupt("return",this.createTaskWithFileObject(e,s,r));case 6:case"end":return i.stop()}}),i,this)})))}},{key:"createTaskWithFileObject",value:function(e,t,r){return c(this,void 0,void 0,u().mark((function i(){var a,o,s,c;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e&&t&&r){i.next=2;break}throw new m("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");case 2:return a=n.constructCreateSessionUrl(r.fileName,r.path),o={fileName:r.fileName,conflictBehavior:r.conflictBehavior},i.next=6,n.createUploadSession(e,a,o);case 6:return s=i.sent,c=te(r.rangeSize),i.abrupt("return",new n(e,t,s,{rangeSize:c,uploadEventHandlers:r.uploadEventHandlers}));case 9:case"end":return i.stop()}}),i)})))}},{key:"createUploadSession",value:function(e,t,r){var i=this,a=Object.create(null,{createUploadSession:{get:function(){return G((0,W.Z)(n),"createUploadSession",i)}}});return c(this,void 0,void 0,u().mark((function n(){var i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={item:{"@microsoft.graph.conflictBehavior":(null===r||void 0===r?void 0:r.conflictBehavior)||"rename",name:null===r||void 0===r?void 0:r.fileName}},n.abrupt("return",a.createUploadSession.call(this,e,t,i));case 2:case"end":return n.stop()}}),n,this)})))}}]),n}($);ne.DEFAULT_UPLOAD_PATH="/";var re=n(5647),ie=n(3433),ae=function(){function e(t){(0,a.Z)(this,e),this.provider=t}return(0,o.Z)(e,[{key:"getAccessToken",value:function(){return c(this,void 0,void 0,u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.provider((function(r,i){return c(t,void 0,void 0,u().mark((function t(){var a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=4;break}e(i),t.next=9;break;case 4:return r||("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md",r=new m("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")),t.next=7,m.setGraphClientError(r);case 7:a=t.sent,n(a);case 9:case"end":return t.stop()}}),t)})))}))})));case 1:case"end":return e.stop()}}),e)})))}}]),e}(),oe=function(e){(0,p.Z)(n,e);var t=(0,v.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return(0,a.Z)(this,n),e=t.call(this,i||o&&o.message),Object.setPrototypeOf((0,h.Z)(e),n.prototype),e.statusCode=r,e.code=null,e.requestId=null,e.date=new Date,e.body=null,e.stack=o?o.stack:e.stack,e}return(0,o.Z)(n)}((0,y.Z)(Error)),se=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"constructError",value:function(e,t){var n=new oe(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n}},{key:"constructErrorFromResponse",value:function(e,t){var n=e.error,r=new oe(t,n.message);return r.code=n.code,void 0!==n.innerError&&(r.requestId=n.innerError["request-id"],r.date=new Date(n.innerError.date)),r.body=JSON.stringify(n),r}},{key:"getError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0;return c(this,void 0,void 0,u().mark((function i(){var a;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t&&t.error?a=e.constructErrorFromResponse(t,n):t instanceof Error?a=e.constructError(t,n):(a=new oe(n)).body=t,"function"!==typeof r){i.next=5;break}r(a,null),i.next=6;break;case 5:return i.abrupt("return",a);case 6:case"end":return i.stop()}}),i)})))}}]),e}(),ue=function(){function e(t,n,r){var o=this;(0,a.Z)(this,e),this.parsePath=function(e){if(-1!==e.indexOf("https://")){var t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(o.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));var n=e.indexOf("/");-1!==n&&(o.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));var r=e.indexOf("?");if(-1===r)o.urlComponents.path=e;else{o.urlComponents.path=e.substr(0,r);var a,s=i(e.substring(r+1,e.length).split("&"));try{for(s.s();!(a=s.n()).done;){var u=a.value;o.parseQueryParameter(u)}}catch(c){s.e(c)}finally{s.f()}}},this.httpClient=t,this.config=n,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}return(0,o.Z)(e,[{key:"addCsvQueryParameter",value:function(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";var r=[];n.length>1&&"string"===typeof t?r=Array.prototype.slice.call(n):"string"===typeof t?r.push(t):r=r.concat(t),this.urlComponents.oDataQueryParams[e]+=r.join(",")}},{key:"buildFullUrl",value:function(){var e=function(e){var t=function(e){return e.replace(/^\/+/,"")};return Array.prototype.slice.call(e).reduce((function(e,n){return[(r=e,r.replace(/\/+$/,"")),t(n)].join("/");var r}))}([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}},{key:"createQueryString",value:function(){var e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(var n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(var r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length){var a,o=i(e.otherURLQueryOptions);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(s)}}catch(u){o.e(u)}finally{o.f()}}return t.length>0?"?"+t.join("&"):""}},{key:"parseQueryParameter",value:function(e){if("string"===typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){var t,n=i(e.split("&"));try{for(n.s();!(t=n.n()).done;){var r=t.value;this.parseQueryParamenterString(r)}}catch(o){n.e(o)}finally{n.f()}}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&this.setURLComponentsQueryParamater(a,e[a]);return this}},{key:"parseQueryParamenterString",value:function(e){if(this.isValidQueryKeyValuePair(e)){var t=e.indexOf("="),n=e.substring(0,t),r=e.substring(t+1);this.setURLComponentsQueryParamater(n,r)}else this.urlComponents.otherURLQueryOptions.push(e)}},{key:"setURLComponentsQueryParamater",value:function(e,t){if(-1!==x.indexOf(e)){var n=this.urlComponents.oDataQueryParams[e],r=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=r?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}},{key:"isValidQueryKeyValuePair",value:function(e){var t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}},{key:"updateRequestOptions",value:function(e){var t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){var n=Object.assign({},this.config.fetchOptions);Object.assign(e,n),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}},{key:"send",value:function(e,t,n){var r;return c(this,void 0,void 0,u().mark((function i(){var a,o,s,c,d,l;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=new R(this._middlewareOptions),this.updateRequestOptions(t),s=null===(r=this.config)||void 0===r?void 0:r.customHosts,i.prev=3,i.next=6,this.httpClient.sendRequest({request:e,options:t,middlewareControl:o,customHosts:s});case 6:return c=i.sent,a=c.response,i.next=10,X.getResponse(a,this._responseType,n);case 10:return d=i.sent,i.abrupt("return",d);case 14:if(i.prev=14,i.t0=i.catch(3),!(i.t0 instanceof m)){i.next=18;break}throw i.t0;case 18:return a&&(l=a.status),i.next=21,se.getError(i.t0,l,n);case 21:throw i.sent;case 23:case"end":return i.stop()}}),i,this,[[3,14]])})))}},{key:"setHeaderContentType",value:function(){if(this._headers){for(var e=0,t=Object.keys(this._headers);e<t.length;e++){if("content-type"===t[e].toLowerCase())return}this.header("Content-Type","application/json")}else this.header("Content-Type","application/json")}},{key:"header",value:function(e,t){return this._headers[e]=t,this}},{key:"headers",value:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}},{key:"option",value:function(e,t){return this._options[e]=t,this}},{key:"options",value:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}},{key:"middlewareOptions",value:function(e){return this._middlewareOptions=e,this}},{key:"version",value:function(e){return this.urlComponents.version=e,this}},{key:"responseType",value:function(e){return this._responseType=e,this}},{key:"select",value:function(e){return this.addCsvQueryParameter("$select",e,arguments),this}},{key:"expand",value:function(e){return this.addCsvQueryParameter("$expand",e,arguments),this}},{key:"orderby",value:function(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}},{key:"filter",value:function(e){return this.urlComponents.oDataQueryParams.$filter=e,this}},{key:"search",value:function(e){return this.urlComponents.oDataQueryParams.$search=e,this}},{key:"top",value:function(e){return this.urlComponents.oDataQueryParams.$top=e,this}},{key:"skip",value:function(e){return this.urlComponents.oDataQueryParams.$skip=e,this}},{key:"skipToken",value:function(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}},{key:"count",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.urlComponents.oDataQueryParams.$count=e.toString(),this}},{key:"query",value:function(e){return this.parseQueryParameter(e)}},{key:"get",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildFullUrl(),r={method:d.GET},t.next=4,this.send(n,r,e);case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"post",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildFullUrl(),i={method:d.POST,body:w(e)},"FormData"===(e&&e.constructor&&e.constructor.name)?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),n.next=6,this.send(r,i,t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"create",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.post(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"put",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildFullUrl(),this.setHeaderContentType(),i={method:d.PUT,body:w(e)},n.next=5,this.send(r,i,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"patch",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildFullUrl(),this.setHeaderContentType(),i={method:d.PATCH,body:w(e)},n.next=5,this.send(r,i,t);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"update",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.patch(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"delete",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildFullUrl(),r={method:d.DELETE},t.next=4,this.send(n,r,e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e){return c(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.delete(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getStream",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildFullUrl(),r={method:d.GET},this.responseType(H.STREAM),t.next=5,this.send(n,r,e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"putStream",value:function(e,t){return c(this,void 0,void 0,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildFullUrl(),i={method:d.PUT,headers:{"Content-Type":"application/octet-stream"},body:e},n.next=4,this.send(r,i,t);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n,this)})))}}]),e}(),ce=function(){function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if((0,a.Z)(this,e),!n||!n.length){var i=new Error;throw i.name="InvalidMiddlewareChain",i.message="Please provide a default middleware chain or custom middleware chain",i}this.setMiddleware.apply(this,n)}return(0,o.Z)(e,[{key:"setMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}},{key:"parseMiddleWareArray",value:function(e){e.forEach((function(t,n){n<e.length-1&&t.setNext(e[n+1])})),this.middleware=e[0]}},{key:"sendRequest",value:function(e){return c(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof e.request||void 0!==e.options){t.next=5;break}throw(n=new Error).name="InvalidRequestOptions",n.message="Unable to execute the middleware, Please provide valid options for a request",n;case 5:return t.next=7,this.middleware.execute(e);case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)})))}}]),e}(),de=function(){function e(){(0,a.Z)(this,e)}return(0,o.Z)(e,null,[{key:"createWithAuthenticationProvider",value:function(t){var n=new U(t),r=new N(new M),i=new F,a=new L;if(n.setNext(r),"object"===typeof process){var o=new q(new I);r.setNext(o),o.setNext(i)}else r.setNext(i);return i.setNext(a),e.createWithMiddleware(n)}},{key:"createWithMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,re.Z)(ce,t)}}]),e}(),le=function(){function e(t){for(var n in(0,a.Z)(this,e),this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},function(){if("undefined"===typeof Promise&&"undefined"===typeof fetch){var e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"===typeof Promise){var t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"===typeof fetch){var n=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw n.name="PolyFillNotAvailable",n}}(),t)Object.prototype.hasOwnProperty.call(t,n)&&(this.config[n]=t[n]);var r;if(void 0!==t.authProvider&&void 0!==t.middleware){var i=new Error;throw i.name="AmbiguityInInitialization",i.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",i}if(void 0!==t.authProvider)r=de.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){var o=new Error;throw o.name="InvalidMiddlewareChain",o.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",o}r=(0,re.Z)(ce,(0,ie.Z)([].concat(t.middleware)))}this.httpClient=r}return(0,o.Z)(e,[{key:"api",value:function(e){return new ue(this.httpClient,this.config,e)}}],[{key:"init",value:function(t){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]="authProvider"===r?new ae(t[r]):t[r]);return e.initWithMiddleware(n)}},{key:"initWithMiddleware",value:function(t){return new e(t)}}]),e}()},6916:function(e,t,n){n.d(t,{P1:function(){return u}});var r="NOT_FOUND";var i=function(e,t){return e===t};function a(e,t){var n="object"===typeof t?t:{equalityCheck:t},a=n.equalityCheck,o=void 0===a?i:a,s=n.maxSize,u=void 0===s?1:s,c=n.resultEqualityCheck,d=function(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}}(o),l=1===u?function(e){var t;return{get:function(n){return t&&e(t.key,n)?t.value:r},put:function(e,n){t={key:e,value:n}},getEntries:function(){return t?[t]:[]},clear:function(){t=void 0}}}(d):function(e,t){var n=[];function i(e){var i=n.findIndex((function(n){return t(e,n.key)}));if(i>-1){var a=n[i];return i>0&&(n.splice(i,1),n.unshift(a)),a.value}return r}return{get:i,put:function(t,a){i(t)===r&&(n.unshift({key:t,value:a}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(u,d);function f(){var t=l.get(arguments);if(t===r){if(t=e.apply(null,arguments),c){var n=l.getEntries(),i=n.find((function(e){return c(e.value,t)}));i&&(t=i.value)}l.put(arguments,t)}return t}return f.clearCache=function(){return l.clear()},f}function o(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var n=t.map((function(e){return"function"===typeof e?"function "+(e.name||"unnamed")+"()":typeof e})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}function s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a,s=0,u={memoizeOptions:void 0},c=r.pop();if("object"===typeof c&&(u=c,c=r.pop()),"function"!==typeof c)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof c+"]");var d=u,l=d.memoizeOptions,f=void 0===l?n:l,h=Array.isArray(f)?f:[f],p=o(r),v=e.apply(void 0,[function(){return s++,c.apply(null,arguments)}].concat(h)),y=e((function(){for(var e=[],t=p.length,n=0;n<t;n++)e.push(p[n].apply(null,arguments));return a=v.apply(null,e)}));return Object.assign(y,{resultFunc:c,memoizedResultFunc:v,dependencies:p,lastResult:function(){return a},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),y};return i}var u=s(a)},6815:function(e,t,n){n.d(t,{Z:function(){return l}});var r,i=n(2791);var a=function(){if(void 0!==r)return r;var e=!1,t={get passive(){e=!0}},n=function(){};return window.addEventListener("t",n,t),window.removeEventListener("t",n,t),r=e,e},o=i.useLayoutEffect,s=function(e){var t=(0,i.useRef)(e);return o((function(){t.current=e})),t},u="touchstart",c=["mousedown",u],d=document;var l=function(e,t,n){var r=(void 0===n?{}:n).document,o=void 0===r?d:r,l=s(t);(0,i.useEffect)((function(){if(t){var n=function(t){e.current&&l.current&&!e.current.contains(t.target)&&l.current(t)};return c.forEach((function(e){o.addEventListener(e,n,function(e){if(e===u&&a())return{passive:!0}}(e))})),function(){c.forEach((function(e){o.removeEventListener(e,n)}))}}}),[!t])}}}]);
//# sourceMappingURL=919.160f2653.chunk.js.map