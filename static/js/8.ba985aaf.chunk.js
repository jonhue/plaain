(this.webpackJsonpplaain=this.webpackJsonpplaain||[]).push([[8],{384:function(e,t,r){},385:function(e,t,r){},395:function(e,t,r){},406:function(e,t,r){"use strict";r.r(t);var n=r(5),c=r.n(n),s=r(13),a=r(54),i=r(1),o=r(23),u=r(20),l=r(65),b=r(102),d=(r(384),r(385),r(101)),j=r.n(d),O=r(7),v=r(3),f=function(e){var t=e.children,r=Object(O.h)(),n=history.length<=2,c=Object(i.useCallback)((function(){return r(-1)}),[r]);return Object(v.jsx)("div",{className:j()("Back",{disabled:n}),onClick:c,children:t})},p=r(50),h=r(29),m=r(386),x=r.n(m),y=r(104),g=function(e,t){var r=e.find((function(e){return e.id===t}));if(void 0===r)throw new Error("Internal error: provider of item does not exist.");return r},k=function(e){return function(t){var r=g(e,t.provider.providerId);return{src:Object(h.e)(r,t.provider),type:"video/".concat(Object(h.k)(t)),size:Object(h.j)(t.provider)}}},w=function(e){return function(t){var r=g(e,t.provider.providerId);return{kind:"captions",label:t.name,srcLang:Object(h.b)(t),src:Object(h.e)(r,t.provider)}}},P=function(e){var t=e.id,r=e.item,n=e.startAt,c=e.onProgress,s=Object(O.h)(),a=Object(o.c)((function(e){return Object(y.b)(e.auth)}));return Object(i.useEffect)((function(){var e=!1,i=new x.a("video.PlyrPlayer#".concat(t),{debug:!1,controls:["play","progress","current-time","mute","volume","captions","settings","fullscreen"],settings:["captions","quality"],autoplay:!0,invertTime:!0,toggleInvert:!0});return i.source={type:"video",title:r.title,sources:r.sources.map(k(a)),tracks:r.captions.map(w(a))},i.on("canplay",(function(){e||void 0===n||i.duration<n||(i.forward(n),e=!0)})),i.on("ended",(function(){s(Object(h.f)(r))})),function(){i.ended?c(0):0!==i.currentTime&&c(i.currentTime),i.destroy()}}),[t,r,s,c,a,n]),Object(v.jsx)("video",{className:"PlyrPlayer",id:t,crossOrigin:"true",playsInline:!0,controls:!0})},N=(r(395),r(298)),_=r(164),C=r(332),A=function(e){var t=e.isActive,r=e.onClose,n=Object(N.a)().t,c=Object(i.useCallback)((function(){return window.location.reload()}),[]);return Object(v.jsx)("div",{className:"VideoDoesNotLoadModal",children:Object(v.jsxs)(C.a,{isActive:t,onClose:r,children:[Object(v.jsx)("h2",{children:n("The video doesn't load?")}),Object(v.jsx)("p",{className:"small",children:Object(v.jsxs)(_.a,{children:["Restarting may help. Please"," ",Object(v.jsx)("a",{href:"https://github.com/jonhue/plaain/issues/new",target:"_blank",rel:"noopener noreferrer",children:"report the issue"})," ","if it persists."]})}),Object(v.jsx)("button",{className:"small",onClick:c,children:n("Reload")})]})})},I=r(333),M=function(e){var t=e.item,r=e.startAt,n=e.onProgress,c=Object(N.a)().t,s=Object(I.a)(),i=Object(a.a)(s,3),o=i[0],u=i[1],l=i[2];return Object(v.jsxs)("div",{className:"Player",children:[Object(v.jsx)(P,{item:t,startAt:r,onProgress:n,id:"player"}),Object(v.jsx)("div",{className:"Player__content",children:Object(v.jsxs)("div",{className:"Player__content__header",children:[Object(v.jsx)("h1",{children:Object(v.jsx)(p.b,{to:Object(h.f)(t),children:t.title})}),Object(v.jsxs)("div",{className:"Player__content__header__actions",children:[Object(v.jsx)("a",{onClick:function(e){e.preventDefault(),u()},children:c("Video not loading?")}),Object(v.jsx)(A,{isActive:o,onClose:l}),Object(v.jsx)(f,{children:Object(v.jsx)("button",{className:"secondary small",children:c("Go back")})})]})]})})]})},L=r(324),R=r(78),E=r(306),S=r(349),T=r(334),U=r(346),D=r(396);t.default=function(){var e=Object(o.b)(),t=Object(O.f)(),r=Object(o.c)((function(e){return{episodes:e.episodes,movies:e.movies}})),n=r.episodes,d=r.movies,j=Object(i.useState)(!1),f=Object(a.a)(j,2),p=f[0],h=f[1],m=Object(i.useMemo)((function(){var e=new URLSearchParams(t.search).get("s");if(null!==e)return Number.parseInt(e)}),[t]),x=Object(i.useMemo)((function(){var e=new URLSearchParams(t.search).get("type");if(null!==e){var r=Number.parseInt(e);return Object.values(u.a).includes(r)?r:void 0}}),[t]),y=Object(i.useCallback)((function(e,t){switch(e){case u.a.Episode:return Object(L.a)(t)(n);case u.a.Movie:return Object(E.b)(t)(d)}}),[n,d]),g=Object(D.useAsyncMemo)(Object(s.a)(c.a.mark((function r(){var n,s,a;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0!==x){r.next=2;break}return r.abrupt("return",h(!0));case 2:if(null!==(n=new URLSearchParams(t.search).get("id"))){r.next=5;break}return r.abrupt("return",h(!0));case 5:if(void 0!==(s=y(x,n))){r.next=8;break}return r.abrupt("return",h(!0));case 8:return r.next=10,e(Object(R.a)(Object(T.c)(s)));case 10:return a=r.sent,r.abrupt("return",a);case 12:case"end":return r.stop()}}),r)}))),[e,x,t,h]),k=Object(i.useCallback)((function(t){if(void 0!==g)switch(g.kind){case u.a.Episode:return e(Object(S.b)(g,t));case u.a.Movie:return e(Object(U.b)(g,t))}}),[e,g]);return void 0!==g&&g.sources.length>0?Object(v.jsx)(M,{item:g,startAt:m,onProgress:k}):p?Object(v.jsx)(b.a,{}):Object(v.jsx)(l.a,{})}}}]);
//# sourceMappingURL=8.ba985aaf.chunk.js.map