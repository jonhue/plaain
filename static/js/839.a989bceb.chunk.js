/*! For license information please see 839.a989bceb.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkplaain=self.webpackChunkplaain||[]).push([[839],{839:function(e,t,n){n.r(t),n.d(t,{NestedAppAuthController:function(){return H}});var r=n(5861),o=n(1413),i=n(5671),a=n(3144),u=n(4687),c=n(290),s=n(2346),l=n(6378),d=n(4190),p=n(2625),h=n(6851),v=n(825),f=n(8051),k=n(2200),A=n(3932),g=n(7232),y=n(9632),E=n(7561),m=n(4430);var w="USER_INTERACTION_REQUIRED",C="USER_CANCEL",I="NO_NETWORK",T="TRANSIENT_ERROR",R="PERSISTENT_ERROR",U="DISABLED",_="ACCOUNT_UNAVAILABLE",N="NESTED_APP_AUTH_UNAVAILABLE",b=function(){function e(t,n,r,o){(0,i.Z)(this,e),this.clientId=t,this.clientCapabilities=n,this.crypto=r,this.logger=o}return(0,a.Z)(e,[{key:"toNaaTokenRequest",value:function(e){var t,n;n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));var r=(new h.H).addClientCapabilitiesToClaims(e.claims,this.clientCapabilities),o=e.scopes||v.f_;return{platformBrokerId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),claims:f.x.isEmptyObj(r)?void 0:r,state:e.state,authenticationScheme:e.authenticationScheme||v.hO.BEARER,extraParameters:n}}},{key:"fromNaaTokenResponse",value:function(e,t,n){if(!t.token.id_token||!t.token.access_token)throw(0,k.zP)(A.PM);var r=new Date(1e3*(n+(t.token.expires_in||0))),o=g.Z_(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!0,expiresOn:r,tokenType:e.authenticationScheme||v.hO.BEARER,correlationId:e.correlationId,extExpiresOn:r,state:e.state}}},{key:"fromNaaAccountInfo",value:function(e,t){var n=t||e.idTokenClaims,r=e.localAccountId||(null===n||void 0===n?void 0:n.oid)||(null===n||void 0===n?void 0:n.sub)||"",o=e.tenantId||(null===n||void 0===n?void 0:n.tid)||"",i=e.homeAccountId||"".concat(r,".").concat(o),a=e.username||(null===n||void 0===n?void 0:n.preferred_username)||"",u=e.name||(null===n||void 0===n?void 0:n.name);return{homeAccountId:i,environment:e.environment,tenantId:o,username:a,localAccountId:r,name:u,idToken:e.idToken,idTokenClaims:n}}},{key:"fromBridgeError",value:function(e){if(!function(e){return void 0!==e.status}(e))return new m.l4("unknown_error","An unknown error occurred");switch(e.status){case C:return new k.er(A.$R);case I:return new k.er(A.Mq);case _:return new k.er(A.cX);case U:return new k.er(A.Ls);case N:return new k.er(e.code||A.Ls,e.description);case T:case R:return new y.n(e.code,e.description);case w:return new E.Yo(e.code,e.description);default:return new m.l4(e.code,e.description)}}}]),e}(),S=n(7326),x=n(136),P=n(9388),q={code:"unsupported_method",desc:"The PKCE code challenge and verifier could not be generated."},B=function(e){(0,x.Z)(n,e);var t=(0,P.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),o=t.call(this,e,r),Object.setPrototypeOf((0,S.Z)(o),n.prototype),o.name="NestedAppAuthError",o}return(0,a.Z)(n,null,[{key:"createUnsupportedError",value:function(){return new n(q.code,q.desc)}}]),n}(m.l4),O=n(4270),Z=n(3057),H=function(){function e(t){(0,i.Z)(this,e),this.operatingContext=t;var n=this.operatingContext.getBridgeProxy();if(void 0===n)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=n,this.config=t.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=t.isBrowserEnvironment()?new p.Q(this.logger,this.performanceClient):c.d,this.eventHandler=new O.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new b(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}return(0,a.Z)(e,[{key:"getBrowserStorage",value:function(){throw B.createUnsupportedError()}},{key:"getEventHandler",value:function(){return this.eventHandler}},{key:"initialize",value:function(){return Promise.resolve()}},{key:"ensureValidRequest",value:function(e){return null!==e&&void 0!==e&&e.correlationId?e:(0,o.Z)((0,o.Z)({},e),{},{correlationId:this.browserCrypto.createNewGuid()})}},{key:"acquireTokenInteractive",value:function(){var e=(0,r.Z)(u.mark((function e(t){var n,r,o,i,a,c,p;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureValidRequest(t),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_START,d.s_.Popup,n),null===(r=this.performanceClient.startMeasurement(s.Ak.AcquireTokenPopup,n.correlationId))||void 0===r||r.add({nestedAppAuthRequest:!0}),e.prev=4,o=this.nestedAppAuthAdapter.toNaaTokenRequest(n),i=l.HY(),e.next=9,this.bridgeProxy.getTokenInteractive(o);case 9:return a=e.sent,c=this.nestedAppAuthAdapter.fromNaaTokenResponse(o,a,i),this.operatingContext.setActiveAccount(c.account),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_SUCCESS,d.s_.Popup,c),r.add({accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),r.end({success:!0,requestId:c.requestId}),e.abrupt("return",c);case 18:throw e.prev=18,e.t0=e.catch(4),p=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_FAILURE,d.s_.Popup,null,e.t0),r.end({success:!1},e.t0),p;case 24:case"end":return e.stop()}}),e,this,[[4,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenSilentInternal",value:function(){var e=(0,r.Z)(u.mark((function e(t){var n,r,o,i,a,c,p;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ensureValidRequest(t),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_START,d.s_.Silent,n),null===(r=this.performanceClient.startMeasurement(s.Ak.SsoSilent,n.correlationId))||void 0===r||r.increment({visibilityChangeCount:0}),null===r||void 0===r||r.add({nestedAppAuthRequest:!0}),e.prev=5,o=this.nestedAppAuthAdapter.toNaaTokenRequest(n),i=l.HY(),e.next=10,this.bridgeProxy.getTokenSilent(o);case 10:return a=e.sent,c=this.nestedAppAuthAdapter.fromNaaTokenResponse(o,a,i),this.operatingContext.setActiveAccount(c.account),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_SUCCESS,d.s_.Silent,c),null===r||void 0===r||r.add({accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),null===r||void 0===r||r.end({success:!0,requestId:c.requestId}),e.abrupt("return",c);case 19:throw e.prev=19,e.t0=e.catch(5),p=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(Z.t.ACQUIRE_TOKEN_FAILURE,d.s_.Silent,null,e.t0),null===r||void 0===r||r.end({success:!1},e.t0),p;case 25:case"end":return e.stop()}}),e,this,[[5,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenPopup",value:function(){var e=(0,r.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenInteractive(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenRedirect",value:function(e){throw B.createUnsupportedError()}},{key:"acquireTokenSilent",value:function(){var e=(0,r.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenSilentInternal(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenByCode",value:function(e){throw B.createUnsupportedError()}},{key:"acquireTokenNative",value:function(e,t,n){throw B.createUnsupportedError()}},{key:"acquireTokenByRefreshToken",value:function(e,t){throw B.createUnsupportedError()}},{key:"addEventCallback",value:function(e){return this.eventHandler.addEventCallback(e)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){throw B.createUnsupportedError()}},{key:"removePerformanceCallback",value:function(e){throw B.createUnsupportedError()}},{key:"enableAccountStorageEvents",value:function(){throw B.createUnsupportedError()}},{key:"disableAccountStorageEvents",value:function(){throw B.createUnsupportedError()}},{key:"getAccount",value:function(e){throw B.createUnsupportedError()}},{key:"getAccountByHomeId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByLocalId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByUsername",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAllAccounts",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}},{key:"handleRedirectPromise",value:function(e){return Promise.resolve(null)}},{key:"loginPopup",value:function(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw B.createUnsupportedError()}},{key:"loginRedirect",value:function(e){throw B.createUnsupportedError()}},{key:"logout",value:function(e){throw B.createUnsupportedError()}},{key:"logoutRedirect",value:function(e){throw B.createUnsupportedError()}},{key:"logoutPopup",value:function(e){throw B.createUnsupportedError()}},{key:"ssoSilent",value:function(e){return this.acquireTokenSilentInternal(e)}},{key:"getTokenCache",value:function(){throw B.createUnsupportedError()}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"setActiveAccount",value:function(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}},{key:"getActiveAccount",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}},{key:"initializeWrapperLibrary",value:function(e,t){}},{key:"setNavigationClient",value:function(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}},{key:"getConfiguration",value:function(){return this.config}},{key:"isBrowserEnv",value:function(){return this.operatingContext.isBrowserEnvironment()}},{key:"getBrowserCrypto",value:function(){return this.browserCrypto}},{key:"getPerformanceClient",value:function(){throw B.createUnsupportedError()}},{key:"getRedirectResponse",value:function(){throw B.createUnsupportedError()}},{key:"clearCache",value:function(){var e=(0,r.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw B.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"hydrateCache",value:function(){var e=(0,r.Z)(u.mark((function e(t,n){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw B.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"createController",value:function(){var t=(0,r.Z)(u.mark((function t(n){var r;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.abrupt("return",Promise.resolve(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=839.a989bceb.chunk.js.map