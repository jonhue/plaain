/*! For license information please see 839.5e03ebed.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkplaain=self.webpackChunkplaain||[]).push([[839],{839:function(e,t,n){n.r(t),n.d(t,{NestedAppAuthController:function(){return S}});var r,o=n(5861),i=n(5671),a=n(3144),u=n(4687),c=n(290),s=n(2346),d=n(6378),l=n(4190),p=n(5548),h=n(6851),v=n(8051),A=n(825),f=n(2200),E=n(3932),k=n(7232),g=n(9632),y=n(7561),C=n(4430);!function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE",e.NESTED_APP_AUTH_UNAVAILABLE="NESTED_APP_AUTH_UNAVAILABLE"}(r||(r={}));var T=function(){function e(t,n,r,o){(0,i.Z)(this,e),this.clientId=t,this.clientCapabilities=n,this.crypto=r,this.logger=o}return(0,a.Z)(e,[{key:"toNaaTokenRequest",value:function(e){var t,n;n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));var r=(new h.H).addClientCapabilitiesToClaims(e.claims,this.clientCapabilities);return{userObjectId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),nonce:e.nonce,claims:v.x.isEmptyObj(r)?void 0:r,state:e.state,authenticationScheme:e.authenticationScheme||A.hO.BEARER,extraParameters:n}}},{key:"fromNaaTokenResponse",value:function(e,t,n){if(!t.id_token||!t.access_token)throw(0,f.zP)(E.PM);var r=new Date(1e3*(n+(t.expires_in||0))),o=k.Z_(t.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,o);return{authority:t.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:t.scope.split(" "),account:i,idToken:void 0!==t.id_token?t.id_token:"",idTokenClaims:o,accessToken:t.access_token,fromCache:!0,expiresOn:r,tokenType:e.authenticationScheme||A.hO.BEARER,correlationId:e.correlationId,extExpiresOn:r,state:e.state}}},{key:"fromNaaAccountInfo",value:function(e,t){var n=t||e.idTokenClaims,r=e.localAccountId||(null===n||void 0===n?void 0:n.oid)||(null===n||void 0===n?void 0:n.sub)||"",o=e.tenantId||(null===n||void 0===n?void 0:n.tid)||"",i=e.homeAccountId||"".concat(r,".").concat(o),a=e.username||(null===n||void 0===n?void 0:n.preferred_username)||"",u=e.name||(null===n||void 0===n?void 0:n.name);return{homeAccountId:i,environment:e.environment,tenantId:o,username:a,localAccountId:r,name:u,idToken:e.idToken,idTokenClaims:n}}},{key:"fromBridgeError",value:function(e){if(!function(e){return void 0!==e.status}(e))return new C.l4("unknown_error","An unknown error occurred");switch(e.status){case r.USER_CANCEL:return new f.er(E.$R);case r.NO_NETWORK:return new f.er(E.Mq);case r.ACCOUNT_UNAVAILABLE:return new f.er(E.cX);case r.DISABLED:return new f.er(E.Ls);case r.NESTED_APP_AUTH_UNAVAILABLE:return new f.er(e.code||E.Ls,e.description);case r.TRANSIENT_ERROR:case r.PERSISTENT_ERROR:return new g.n(e.code,e.description);case r.USER_INTERACTION_REQUIRED:return new y.Yo(e.code,e.description);default:return new C.l4(e.code,e.description)}}}]),e}(),w=n(7326),I=n(136),m=n(9388),R={code:"unsupported_method",desc:"The PKCE code challenge and verifier could not be generated."},N=function(e){(0,I.Z)(n,e);var t=(0,m.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),o=t.call(this,e,r),Object.setPrototypeOf((0,w.Z)(o),n.prototype),o.name="NestedAppAuthError",o}return(0,a.Z)(n,null,[{key:"createUnsupportedError",value:function(){return new n(R.code,R.desc)}}]),n}(C.l4),_=n(4270),U=n(3057),S=function(){function e(t){(0,i.Z)(this,e),this.operatingContext=t;var n=this.operatingContext.getBridgeProxy();if(void 0===n)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=n,this.config=t.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=t.isBrowserEnvironment()?new p.Q(this.logger,this.performanceClient):c.d,this.eventHandler=new _.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new T(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}return(0,a.Z)(e,[{key:"getBrowserStorage",value:function(){throw N.createUnsupportedError()}},{key:"getEventHandler",value:function(){return this.eventHandler}},{key:"initialize",value:function(){return Promise.resolve()}},{key:"acquireTokenInteractive",value:function(){var e=(0,o.Z)(u.mark((function e(t){var n,r,o,i,a,c;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_START,l.s_.Popup,t),null===(n=this.performanceClient.startMeasurement(s.Ak.AcquireTokenPopup,t.correlationId))||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=3,r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=d.I.nowSeconds(),e.next=8,this.bridgeProxy.getTokenInteractive(r);case 8:return i=e.sent,a=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o),this.operatingContext.setActiveAccount(a.account),this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Popup,a),n.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),n.end({success:!0,requestId:a.requestId}),e.abrupt("return",a);case 17:throw e.prev=17,e.t0=e.catch(3),c=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_FAILURE,l.s_.Popup,null,e.t0),n.end({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c;case 23:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenSilentInternal",value:function(){var e=(0,o.Z)(u.mark((function e(t){var n,r,o,i,a,c;return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_START,l.s_.Silent,t),null===(n=this.performanceClient.startMeasurement(s.Ak.SsoSilent,t.correlationId))||void 0===n||n.increment({visibilityChangeCount:0}),null===n||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=4,r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=d.I.nowSeconds(),e.next=9,this.bridgeProxy.getTokenSilent(r);case 9:return i=e.sent,a=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o),this.operatingContext.setActiveAccount(a.account),this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Silent,a),null===n||void 0===n||n.add({accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length}),null===n||void 0===n||n.end({success:!0,requestId:a.requestId}),e.abrupt("return",a);case 18:throw e.prev=18,e.t0=e.catch(4),c=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(U.t.ACQUIRE_TOKEN_FAILURE,l.s_.Silent,null,e.t0),null===n||void 0===n||n.end({errorCode:c.errorCode,subErrorCode:c.subError,success:!1}),c;case 24:case"end":return e.stop()}}),e,this,[[4,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenPopup",value:function(){var e=(0,o.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenInteractive(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenRedirect",value:function(e){throw N.createUnsupportedError()}},{key:"acquireTokenSilent",value:function(){var e=(0,o.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenSilentInternal(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenByCode",value:function(e){throw N.createUnsupportedError()}},{key:"acquireTokenNative",value:function(e,t,n){throw N.createUnsupportedError()}},{key:"acquireTokenByRefreshToken",value:function(e,t){throw N.createUnsupportedError()}},{key:"addEventCallback",value:function(e){return this.eventHandler.addEventCallback(e)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){throw N.createUnsupportedError()}},{key:"removePerformanceCallback",value:function(e){throw N.createUnsupportedError()}},{key:"enableAccountStorageEvents",value:function(){throw N.createUnsupportedError()}},{key:"disableAccountStorageEvents",value:function(){throw N.createUnsupportedError()}},{key:"getAccount",value:function(e){throw N.createUnsupportedError()}},{key:"getAccountByHomeId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByLocalId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByUsername",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAllAccounts",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}},{key:"handleRedirectPromise",value:function(e){throw N.createUnsupportedError()}},{key:"loginPopup",value:function(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw N.createUnsupportedError()}},{key:"loginRedirect",value:function(e){throw N.createUnsupportedError()}},{key:"logout",value:function(e){throw N.createUnsupportedError()}},{key:"logoutRedirect",value:function(e){throw N.createUnsupportedError()}},{key:"logoutPopup",value:function(e){throw N.createUnsupportedError()}},{key:"ssoSilent",value:function(e){return this.acquireTokenSilentInternal(e)}},{key:"getTokenCache",value:function(){throw N.createUnsupportedError()}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"setActiveAccount",value:function(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}},{key:"getActiveAccount",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}},{key:"initializeWrapperLibrary",value:function(e,t){}},{key:"setNavigationClient",value:function(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}},{key:"getConfiguration",value:function(){return this.config}},{key:"isBrowserEnv",value:function(){return this.operatingContext.isBrowserEnvironment()}},{key:"getBrowserCrypto",value:function(){return this.browserCrypto}},{key:"getPerformanceClient",value:function(){throw N.createUnsupportedError()}},{key:"getRedirectResponse",value:function(){throw N.createUnsupportedError()}},{key:"preflightBrowserEnvironmentCheck",value:function(e,t){throw N.createUnsupportedError()}},{key:"clearCache",value:function(){var e=(0,o.Z)(u.mark((function e(t){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw N.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"hydrateCache",value:function(){var e=(0,o.Z)(u.mark((function e(t,n){return u.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw N.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"createController",value:function(){var t=(0,o.Z)(u.mark((function t(n){var r;return u.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.abrupt("return",Promise.resolve(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=839.5e03ebed.chunk.js.map