/*! For license information please see 839.bb83529c.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkplaain=self.webpackChunkplaain||[]).push([[839],{839:function(e,t,n){n.r(t),n.d(t,{NestedAppAuthController:function(){return N}});var r,o=n(5861),i=n(5671),a=n(3144),c=n(4687),u=n(290),s=n(2346),p=n(4190),d=n(5548),l=n(6378),h=n(7232),v=n(2200),A=n(3932),f=n(9632),k=n(7561),E=n(4430);!function(e){e.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",e.USER_CANCEL="USER_CANCEL",e.NO_NETWORK="NO_NETWORK",e.TRANSIENT_ERROR="TRANSIENT_ERROR",e.PERSISTENT_ERROR="PERSISTENT_ERROR",e.DISABLED="DISABLED",e.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE",e.NESTED_APP_AUTH_UNAVAILABLE="NESTED_APP_AUTH_UNAVAILABLE"}(r||(r={}));var m=function(){function e(t,n,r,o){(0,i.Z)(this,e),this.clientId=t,this.clientCapabilities=n,this.crypto=r,this.logger=o}return(0,a.Z)(e,[{key:"toNaaSilentTokenRequest",value:function(e){var t,n;return n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters)),{userObjectId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),prompt:void 0!==e.prompt?e.prompt:"",claims:void 0!==e.claims?e.claims:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:this.clientCapabilities,extraParameters:n}}},{key:"toNaaTokenRequest",value:function(e){var t,n;return n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters)),{userObjectId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:"",prompt:void 0!==e.prompt?e.prompt:"",nonce:void 0!==e.nonce?e.nonce:"",claims:void 0!==e.claims?e.claims:"",state:void 0!==e.state?e.state:"",authenticationScheme:void 0!==e.authenticationScheme?e.authenticationScheme:"",clientCapabilities:void 0,extraParameters:n}}},{key:"fromNaaTokenResponse",value:function(e,t){var n=new Date(l.I.nowSeconds()+1e3*(t.expires_in||0)),r=this.fromNaaAccountInfo(t.account);return{authority:t.account.environment,uniqueId:t.account.homeAccountId,tenantId:t.account.tenantId,scopes:t.scope.split(" "),account:this.fromNaaAccountInfo(t.account),idToken:void 0!==t.id_token?t.id_token:"",idTokenClaims:void 0!==r.idTokenClaims?r.idTokenClaims:{},accessToken:t.access_token,fromCache:!0,expiresOn:n,tokenType:void 0!==e.authenticationScheme?e.authenticationScheme:"Bearer",correlationId:e.correlationId,requestId:"",extExpiresOn:n,state:t.state}}},{key:"fromNaaAccountInfo",value:function(e){var t;return t=void 0!==e.idToken?h.Z_(e.idToken,this.crypto.base64Decode):void 0,{homeAccountId:e.homeAccountId,environment:e.environment,tenantId:e.tenantId,username:e.username,localAccountId:e.localAccountId,name:e.name,idToken:e.idToken,idTokenClaims:t}}},{key:"fromBridgeError",value:function(e){if(!function(e){return void 0!==e.status}(e))return new E.l4("unknown_error","An unknown error occurred");switch(e.status){case r.USER_CANCEL:return new v.er(A.$R);case r.NO_NETWORK:return new v.er(A.Mq);case r.ACCOUNT_UNAVAILABLE:return new v.er(A.cX);case r.DISABLED:return new v.er(A.Ls);case r.NESTED_APP_AUTH_UNAVAILABLE:return new v.er(e.code,e.description);case r.TRANSIENT_ERROR:case r.PERSISTENT_ERROR:return new f.n(e.code,e.description);case r.USER_INTERACTION_REQUIRED:return new k.Yo(e.code,e.description);default:return new E.l4(e.code,e.description)}}}]),e}(),g=n(7326),y=n(136),I=n(9388),C={code:"unsupported_method",desc:"The PKCE code challenge and verifier could not be generated."},T=function(e){(0,y.Z)(n,e);var t=(0,I.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),o=t.call(this,e,r),Object.setPrototypeOf((0,g.Z)(o),n.prototype),o.name="NestedAppAuthError",o}return(0,a.Z)(n,null,[{key:"createUnsupportedError",value:function(){return new n(C.code,C.desc)}}]),n}(E.l4),w=n(4270),R=n(3057),N=function(){function e(t){(0,i.Z)(this,e),this.operatingContext=t;var n=this.operatingContext.getBridgeProxy();if(void 0===n)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=n,this.config=t.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=t.isBrowserEnvironment()?new d.Q(this.logger,this.performanceClient):u.d,this.eventHandler=new w.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new m(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}return(0,a.Z)(e,[{key:"getBrowserStorage",value:function(){throw T.createUnsupportedError()}},{key:"getEventHandler",value:function(){return this.eventHandler}},{key:"initialize",value:function(){return Promise.resolve()}},{key:"acquireTokenInteractive",value:function(){var e=(0,o.Z)(c.mark((function e(t){var n,r,o,i,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_START,p.s_.Popup,t),null===(n=this.performanceClient.startMeasurement(s.Ak.AcquireTokenPopup,t.correlationId))||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=3,r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),e.next=7,this.bridgeProxy.getTokenInteractive(r);case 7:return o=e.sent,i=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,o),this.operatingContext.setActiveAccount(i.account),this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_SUCCESS,p.s_.Popup,i),n.add({accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length}),n.end({success:!0,requestId:i.requestId}),e.abrupt("return",i);case 16:throw e.prev=16,e.t0=e.catch(3),a=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_FAILURE,p.s_.Popup,null,e.t0),n.end({errorCode:a.errorCode,subErrorCode:a.subError,success:!1}),a;case 22:case"end":return e.stop()}}),e,this,[[3,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenSilentInternal",value:function(){var e=(0,o.Z)(c.mark((function e(t){var n,r,o,i,a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_START,p.s_.Silent,t),null===(n=this.performanceClient.startMeasurement(s.Ak.SsoSilent,t.correlationId))||void 0===n||n.increment({visibilityChangeCount:0}),null===n||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=4,r=this.nestedAppAuthAdapter.toNaaSilentTokenRequest(t),e.next=8,this.bridgeProxy.getTokenSilent(r);case 8:return o=e.sent,i=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,o),this.operatingContext.setActiveAccount(i.account),this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_SUCCESS,p.s_.Silent,i),null===n||void 0===n||n.add({accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length}),null===n||void 0===n||n.end({success:!0,requestId:i.requestId}),e.abrupt("return",i);case 17:throw e.prev=17,e.t0=e.catch(4),a=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(R.t.ACQUIRE_TOKEN_FAILURE,p.s_.Silent,null,e.t0),null===n||void 0===n||n.end({errorCode:a.errorCode,subErrorCode:a.subError,success:!1}),a;case 23:case"end":return e.stop()}}),e,this,[[4,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenPopup",value:function(){var e=(0,o.Z)(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenInteractive(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenRedirect",value:function(e){throw T.createUnsupportedError()}},{key:"acquireTokenSilent",value:function(){var e=(0,o.Z)(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenSilentInternal(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenByCode",value:function(e){throw T.createUnsupportedError()}},{key:"acquireTokenNative",value:function(e,t,n){throw T.createUnsupportedError()}},{key:"acquireTokenByRefreshToken",value:function(e,t){throw T.createUnsupportedError()}},{key:"addEventCallback",value:function(e){return this.eventHandler.addEventCallback(e)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){throw T.createUnsupportedError()}},{key:"removePerformanceCallback",value:function(e){throw T.createUnsupportedError()}},{key:"enableAccountStorageEvents",value:function(){throw T.createUnsupportedError()}},{key:"disableAccountStorageEvents",value:function(){throw T.createUnsupportedError()}},{key:"getAccount",value:function(e){throw T.createUnsupportedError()}},{key:"getAccountByHomeId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByLocalId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByUsername",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAllAccounts",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}},{key:"handleRedirectPromise",value:function(e){throw T.createUnsupportedError()}},{key:"loginPopup",value:function(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw T.createUnsupportedError()}},{key:"loginRedirect",value:function(e){throw T.createUnsupportedError()}},{key:"logout",value:function(e){throw T.createUnsupportedError()}},{key:"logoutRedirect",value:function(e){throw T.createUnsupportedError()}},{key:"logoutPopup",value:function(e){throw T.createUnsupportedError()}},{key:"ssoSilent",value:function(e){return this.acquireTokenSilentInternal(e)}},{key:"getTokenCache",value:function(){throw T.createUnsupportedError()}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"setActiveAccount",value:function(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}},{key:"getActiveAccount",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}},{key:"initializeWrapperLibrary",value:function(e,t){}},{key:"setNavigationClient",value:function(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}},{key:"getConfiguration",value:function(){return this.config}},{key:"isBrowserEnv",value:function(){return this.operatingContext.isBrowserEnvironment()}},{key:"getBrowserCrypto",value:function(){return this.browserCrypto}},{key:"getPerformanceClient",value:function(){throw T.createUnsupportedError()}},{key:"getRedirectResponse",value:function(){throw T.createUnsupportedError()}},{key:"preflightBrowserEnvironmentCheck",value:function(e,t){throw T.createUnsupportedError()}},{key:"clearCache",value:function(){var e=(0,o.Z)(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw T.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"hydrateCache",value:function(){var e=(0,o.Z)(c.mark((function e(t,n){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw T.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"createController",value:function(){var t=(0,o.Z)(c.mark((function t(n){var r;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.abrupt("return",Promise.resolve(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=839.bb83529c.chunk.js.map