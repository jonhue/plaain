/*! For license information please see 839.171552b1.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkplaain=self.webpackChunkplaain||[]).push([[839],{839:function(e,t,n){n.r(t),n.d(t,{NestedAppAuthController:function(){return Z}});var r=n(5861),o=n(5671),i=n(3144),a=n(4687),u=n(290),c=n(2346),s=n(6378),l=n(4190),d=n(5548),p=n(6851),h=n(8051),v=n(825),f=n(2200),k=n(3932),A=n(7232),g=n(9632),y=n(7561),E=n(4430);var m="USER_INTERACTION_REQUIRED",w="USER_CANCEL",C="NO_NETWORK",I="TRANSIENT_ERROR",T="PERSISTENT_ERROR",R="DISABLED",U="ACCOUNT_UNAVAILABLE",b="NESTED_APP_AUTH_UNAVAILABLE",S=function(){function e(t,n,r,i){(0,o.Z)(this,e),this.clientId=t,this.clientCapabilities=n,this.crypto=r,this.logger=i}return(0,i.Z)(e,[{key:"toNaaTokenRequest",value:function(e){var t,n;n=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));var r=(new p.H).addClientCapabilitiesToClaims(e.claims,this.clientCapabilities);return{platformBrokerId:null===(t=e.account)||void 0===t?void 0:t.homeAccountId,clientId:this.clientId,authority:e.authority,scope:e.scopes.join(" "),correlationId:void 0!==e.correlationId?e.correlationId:this.crypto.createNewGuid(),claims:h.x.isEmptyObj(r)?void 0:r,state:e.state,authenticationScheme:e.authenticationScheme||v.hO.BEARER,extraParameters:n}}},{key:"fromNaaTokenResponse",value:function(e,t,n){if(!t.token.id_token||!t.token.access_token)throw(0,f.zP)(k.PM);var r=new Date(1e3*(n+(t.token.expires_in||0))),o=A.Z_(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!0,expiresOn:r,tokenType:e.authenticationScheme||v.hO.BEARER,correlationId:e.correlationId,extExpiresOn:r,state:e.state}}},{key:"fromNaaAccountInfo",value:function(e,t){var n=t||e.idTokenClaims,r=e.localAccountId||(null===n||void 0===n?void 0:n.oid)||(null===n||void 0===n?void 0:n.sub)||"",o=e.tenantId||(null===n||void 0===n?void 0:n.tid)||"",i=e.homeAccountId||"".concat(r,".").concat(o),a=e.username||(null===n||void 0===n?void 0:n.preferred_username)||"",u=e.name||(null===n||void 0===n?void 0:n.name);return{homeAccountId:i,environment:e.environment,tenantId:o,username:a,localAccountId:r,name:u,idToken:e.idToken,idTokenClaims:n}}},{key:"fromBridgeError",value:function(e){if(!function(e){return void 0!==e.status}(e))return new E.l4("unknown_error","An unknown error occurred");switch(e.status){case w:return new f.er(k.$R);case C:return new f.er(k.Mq);case U:return new f.er(k.cX);case R:return new f.er(k.Ls);case b:return new f.er(e.code||k.Ls,e.description);case I:case T:return new g.n(e.code,e.description);case m:return new y.Yo(e.code,e.description);default:return new E.l4(e.code,e.description)}}}]),e}(),_=n(7326),N=n(136),x=n(9388),P={code:"unsupported_method",desc:"The PKCE code challenge and verifier could not be generated."},q=function(e){(0,N.Z)(n,e);var t=(0,x.Z)(n);function n(e,r){var i;return(0,o.Z)(this,n),i=t.call(this,e,r),Object.setPrototypeOf((0,_.Z)(i),n.prototype),i.name="NestedAppAuthError",i}return(0,i.Z)(n,null,[{key:"createUnsupportedError",value:function(){return new n(P.code,P.desc)}}]),n}(E.l4),B=n(4270),O=n(3057),Z=function(){function e(t){(0,o.Z)(this,e),this.operatingContext=t;var n=this.operatingContext.getBridgeProxy();if(void 0===n)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=n,this.config=t.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=t.isBrowserEnvironment()?new d.Q(this.logger,this.performanceClient):u.d,this.eventHandler=new B.b(this.logger,this.browserCrypto),this.nestedAppAuthAdapter=new S(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger)}return(0,i.Z)(e,[{key:"getBrowserStorage",value:function(){throw q.createUnsupportedError()}},{key:"getEventHandler",value:function(){return this.eventHandler}},{key:"initialize",value:function(){return Promise.resolve()}},{key:"acquireTokenInteractive",value:function(){var e=(0,r.Z)(a.mark((function e(t){var n,r,o,i,u,d;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_START,l.s_.Popup,t),null===(n=this.performanceClient.startMeasurement(c.Ak.AcquireTokenPopup,t.correlationId))||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=3,r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=s.I.nowSeconds(),e.next=8,this.bridgeProxy.getTokenInteractive(r);case 8:return i=e.sent,u=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o),this.operatingContext.setActiveAccount(u.account),this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Popup,u),n.add({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),n.end({success:!0,requestId:u.requestId}),e.abrupt("return",u);case 17:throw e.prev=17,e.t0=e.catch(3),d=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_FAILURE,l.s_.Popup,null,e.t0),n.end({errorCode:d.errorCode,subErrorCode:d.subError,success:!1}),d;case 23:case"end":return e.stop()}}),e,this,[[3,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenSilentInternal",value:function(){var e=(0,r.Z)(a.mark((function e(t){var n,r,o,i,u,d;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_START,l.s_.Silent,t),null===(n=this.performanceClient.startMeasurement(c.Ak.SsoSilent,t.correlationId))||void 0===n||n.increment({visibilityChangeCount:0}),null===n||void 0===n||n.add({nestedAppAuthRequest:!0}),e.prev=4,r=this.nestedAppAuthAdapter.toNaaTokenRequest(t),o=s.I.nowSeconds(),e.next=9,this.bridgeProxy.getTokenSilent(r);case 9:return i=e.sent,u=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,i,o),this.operatingContext.setActiveAccount(u.account),this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_SUCCESS,l.s_.Silent,u),null===n||void 0===n||n.add({accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),null===n||void 0===n||n.end({success:!0,requestId:u.requestId}),e.abrupt("return",u);case 18:throw e.prev=18,e.t0=e.catch(4),d=this.nestedAppAuthAdapter.fromBridgeError(e.t0),this.eventHandler.emitEvent(O.t.ACQUIRE_TOKEN_FAILURE,l.s_.Silent,null,e.t0),null===n||void 0===n||n.end({errorCode:d.errorCode,subErrorCode:d.subError,success:!1}),d;case 24:case"end":return e.stop()}}),e,this,[[4,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenPopup",value:function(){var e=(0,r.Z)(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenInteractive(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenRedirect",value:function(e){throw q.createUnsupportedError()}},{key:"acquireTokenSilent",value:function(){var e=(0,r.Z)(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.acquireTokenSilentInternal(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acquireTokenByCode",value:function(e){throw q.createUnsupportedError()}},{key:"acquireTokenNative",value:function(e,t,n){throw q.createUnsupportedError()}},{key:"acquireTokenByRefreshToken",value:function(e,t){throw q.createUnsupportedError()}},{key:"addEventCallback",value:function(e){return this.eventHandler.addEventCallback(e)}},{key:"removeEventCallback",value:function(e){this.eventHandler.removeEventCallback(e)}},{key:"addPerformanceCallback",value:function(e){throw q.createUnsupportedError()}},{key:"removePerformanceCallback",value:function(e){throw q.createUnsupportedError()}},{key:"enableAccountStorageEvents",value:function(){throw q.createUnsupportedError()}},{key:"disableAccountStorageEvents",value:function(){throw q.createUnsupportedError()}},{key:"getAccount",value:function(e){throw q.createUnsupportedError()}},{key:"getAccountByHomeId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.homeAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByLocalId",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.localAccountId===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAccountByUsername",value:function(e){var t=this.operatingContext.getActiveAccount();return void 0!==t&&t.username===e?this.nestedAppAuthAdapter.fromNaaAccountInfo(t):null}},{key:"getAllAccounts",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?[this.nestedAppAuthAdapter.fromNaaAccountInfo(e)]:[]}},{key:"handleRedirectPromise",value:function(e){throw q.createUnsupportedError()}},{key:"loginPopup",value:function(e){if(void 0!==e)return this.acquireTokenInteractive(e);throw q.createUnsupportedError()}},{key:"loginRedirect",value:function(e){throw q.createUnsupportedError()}},{key:"logout",value:function(e){throw q.createUnsupportedError()}},{key:"logoutRedirect",value:function(e){throw q.createUnsupportedError()}},{key:"logoutPopup",value:function(e){throw q.createUnsupportedError()}},{key:"ssoSilent",value:function(e){return this.acquireTokenSilentInternal(e)}},{key:"getTokenCache",value:function(){throw q.createUnsupportedError()}},{key:"getLogger",value:function(){return this.logger}},{key:"setLogger",value:function(e){this.logger=e}},{key:"setActiveAccount",value:function(e){this.logger.warning("nestedAppAuth does not support setActiveAccount")}},{key:"getActiveAccount",value:function(){var e=this.operatingContext.getActiveAccount();return void 0!==e?this.nestedAppAuthAdapter.fromNaaAccountInfo(e):null}},{key:"initializeWrapperLibrary",value:function(e,t){}},{key:"setNavigationClient",value:function(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}},{key:"getConfiguration",value:function(){return this.config}},{key:"isBrowserEnv",value:function(){return this.operatingContext.isBrowserEnvironment()}},{key:"getBrowserCrypto",value:function(){return this.browserCrypto}},{key:"getPerformanceClient",value:function(){throw q.createUnsupportedError()}},{key:"getRedirectResponse",value:function(){throw q.createUnsupportedError()}},{key:"preflightBrowserEnvironmentCheck",value:function(e,t){throw q.createUnsupportedError()}},{key:"clearCache",value:function(){var e=(0,r.Z)(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw q.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"hydrateCache",value:function(){var e=(0,r.Z)(a.mark((function e(t,n){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw q.createUnsupportedError();case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"createController",value:function(){var t=(0,r.Z)(a.mark((function t(n){var r;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e(n),t.abrupt("return",Promise.resolve(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}()}}]);
//# sourceMappingURL=839.171552b1.chunk.js.map