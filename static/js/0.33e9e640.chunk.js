(this.webpackJsonpplaain=this.webpackJsonpplaain||[]).push([[0],{296:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));function n(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(t){i(t)}}function s(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}},299:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(109);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(u){a=!0,i=u}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return r}}(e,t)||Object(n.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},303:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(319),a=r(25),i=r(102),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(a.a)(this,e),this.middlewareOptions=new Map;var r,i=Object(n.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.constructor;this.middlewareOptions.set(s,o)}}catch(u){i.e(u)}finally{i.f()}}return Object(i.a)(e,[{key:"getMiddlewareOptions",value:function(e){return this.middlewareOptions.get(e)}},{key:"setMiddlewareOptions",value:function(e,t){this.middlewareOptions.set(e,t)}}]),e}()},306:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));var n,a=r(25),i=r(102),o=r(303);!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(n||(n={}));var s=function(){function e(){Object(a.a)(this,e),this.featureUsage=n.NONE}return Object(i.a)(e,[{key:"setFeatureUsage",value:function(e){this.featureUsage=this.featureUsage|e}},{key:"getFeatureUsage",value:function(){return this.featureUsage.toString(16)}}],[{key:"updateFeatureUsageFlag",value:function(t,r){var n;t.middlewareControl instanceof o.a?n=t.middlewareControl.getMiddlewareOptions(e):t.middlewareControl=new o.a,"undefined"===typeof n&&(n=new e,t.middlewareControl.setMiddlewareOptions(e,n)),n.setFeatureUsage(r)}}]),e}()},307:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f}));var n=r(2),a=r.n(n),i=r(14),o=r(296),s=function(){for(var e="",t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},u=function(e,t,r){var n=null;if("undefined"!==typeof Request&&e instanceof Request)n=e.headers.get(r);else if("undefined"!==typeof t&&void 0!==t.headers)if("undefined"!==typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){for(var a=t.headers,i=0,o=a.length;i<o;i++)if(a[i][0]===r){n=a[i][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},c=function(e,t,r,n){if("undefined"!==typeof Request&&e instanceof Request)e.headers.set(r,n);else if("undefined"!==typeof t)if(void 0===t.headers)t.headers=new Headers(Object(i.a)({},r,n));else if("undefined"!==typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){for(var a=0,o=t.headers.length;a<o;a++){var s=t.headers[a];if(s[0]===r){s[1]=n;break}}a===o&&t.headers.push([r,n])}else Object.assign(t.headers,Object(i.a)({},r,n))},d=function(e,t,r,n){"undefined"!==typeof Request&&e instanceof Request?e.headers.append(r,n):"undefined"!==typeof t&&(void 0===t.headers?t.headers=new Headers(Object(i.a)({},r,n)):"undefined"!==typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers=Object(i.a)({},r,n):void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=", ".concat(n))},f=function(e,t){return o.a(undefined,void 0,void 0,a.a.mark((function r(){var n,i,o,s,u,c,d,f,h,l,p,v;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.headers.get("Content-Type")){r.next=6;break}return r.next=3,t.blob();case 3:r.t0=r.sent,r.next=9;break;case 6:return r.next=8,Promise.resolve(void 0);case 8:r.t0=r.sent;case 9:return n=r.t0,i=t.method,o=t.headers,s=t.referrer,u=t.referrerPolicy,c=t.mode,d=t.credentials,f=t.cache,h=t.redirect,l=t.integrity,p=t.keepalive,v=t.signal,r.abrupt("return",new Request(e,{method:i,headers:o,body:n,referrer:s,referrerPolicy:u,mode:c,credentials:d,cache:f,redirect:h,integrity:l,keepalive:p,signal:v}));case 12:case"end":return r.stop()}}),r)})))}},308:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(25),a=r(102),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_DELAY,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAX_RETRIES,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.DEFAULT_SHOULD_RETRY;if(Object(n.a)(this,e),t>e.MAX_DELAY&&r>e.MAX_MAX_RETRIES){var i=new Error("Delay and MaxRetries should not be more than ".concat(e.MAX_DELAY," and ").concat(e.MAX_MAX_RETRIES));throw i.name="MaxLimitExceeded",i}if(t>e.MAX_DELAY){var o=new Error("Delay should not be more than ".concat(e.MAX_DELAY));throw o.name="MaxLimitExceeded",o}if(r>e.MAX_MAX_RETRIES){var s=new Error("MaxRetries should not be more than ".concat(e.MAX_MAX_RETRIES));throw s.name="MaxLimitExceeded",s}if(t<0&&r<0){var u=new Error("Delay and MaxRetries should not be negative");throw u.name="MinExpectationNotMet",u}if(t<0){var c=new Error("Delay should not be negative");throw c.name="MinExpectationNotMet",c}if(r<0){var d=new Error("MaxRetries should not be negative");throw d.name="MinExpectationNotMet",d}this.delay=Math.min(t,e.MAX_DELAY),this.maxRetries=Math.min(r,e.MAX_MAX_RETRIES),this.shouldRetry=a}return Object(a.a)(e,[{key:"getMaxDelay",value:function(){return e.MAX_DELAY}}]),e}();i.DEFAULT_DELAY=3,i.DEFAULT_MAX_RETRIES=3,i.MAX_DELAY=180,i.MAX_MAX_RETRIES=10,i.DEFAULT_SHOULD_RETRY=function(){return!0}},309:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(25),a=function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_MAX_REDIRECTS,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_SHOULD_RETRY;return function(){if(Object(n.a)(t,e),r>e.MAX_MAX_REDIRECTS){var i=new Error("MaxRedirects should not be more than ".concat(e.MAX_MAX_REDIRECTS));throw i.name="MaxLimitExceeded",i}if(r<0){var o=new Error("MaxRedirects should not be negative");throw o.name="MinExpectationNotMet",o}t.maxRedirects=r,t.shouldRedirect=a}()};a.DEFAULT_MAX_REDIRECTS=5,a.MAX_MAX_REDIRECTS=20,a.DEFAULT_SHOULD_RETRY=function(){return!0}},310:function(e,t,r){"use strict";function n(e,t){return e===t}function a(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,a=0;a<n;a++)if(!e(t[a],r[a]))return!1;return!0}function i(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var r=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}r.d(t,"a",(function(){return o}));var o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];var o=0,s=n.pop(),u=i(n),c=e.apply(void 0,[function(){return o++,s.apply(null,arguments)}].concat(r)),d=e((function(){for(var e=[],t=u.length,r=0;r<t;r++)e.push(u[r].apply(null,arguments));return c.apply(null,e)}));return d.resultFunc=s,d.dependencies=u,d.recomputations=function(){return o},d.resetRecomputations=function(){return o=0},d}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,i=null;return function(){return a(t,r,arguments)||(i=e.apply(null,arguments)),r=arguments,i}}))},311:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(n||(n={}))},312:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=r(303),c=r(307),d=r(320),f=r(306),h=function(){function e(t){Object(i.a)(this,e),this.authenticationProvider=t}return Object(o.a)(e,[{key:"execute",value:function(t){return s.a(this,void 0,void 0,a.a.mark((function r(){var n,i,o,s,h;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.middlewareControl instanceof u.a&&(n=t.middlewareControl.getMiddlewareOptions(d.a)),"undefined"!==typeof n&&(i=n.authenticationProvider,o=n.authenticationProviderOptions),"undefined"===typeof i&&(i=this.authenticationProvider),r.next=6,i.getAccessToken(o);case 6:return s=r.sent,h="Bearer ".concat(s),Object(c.a)(t.request,t.options,e.AUTHORIZATION_HEADER,h),f.b.updateFeatureUsageFlag(t,f.a.AUTHENTICATION_HANDLER_ENABLED),r.next=12,this.nextMiddleware.execute(t);case 12:return r.abrupt("return",r.sent);case 15:throw r.prev=15,r.t0=r.catch(0),r.t0;case 18:case"end":return r.stop()}}),r,this,[[0,15]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();h.AUTHORIZATION_HEADER="Authorization"},313:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"execute",value:function(e){return s.a(this,void 0,void 0,a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e.request,e.options);case 3:return e.response=t.sent,t.abrupt("return");case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))}}]),e}()},314:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=r(311),c=r(303),d=r(307),f=r(308),h=r(306),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f.a;Object(i.a)(this,e),this.options=t}return Object(o.a)(e,[{key:"isRetry",value:function(t){return-1!==e.RETRY_STATUS_CODES.indexOf(t.status)}},{key:"isBuffered",value:function(e,t){var r="string"===typeof e?t.method:e.method;if((r===u.a.PUT||r===u.a.PATCH||r===u.a.POST)&&"application/octet-stream"===Object(d.d)(e,t,"Content-Type"))return!1;return!0}},{key:"getDelay",value:function(t,r,n){var a,i=function(){return Number(Math.random().toFixed(3))},o=void 0!==t.headers?t.headers.get(e.RETRY_AFTER_HEADER):null;return a=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):r>=2?this.getExponentialBackOffTime(r)+n+i():n+i(),Math.min(a,this.options.getMaxDelay()+i())}},{key:"getExponentialBackOffTime",value:function(e){return Math.round(.5*(Math.pow(2,e)-1))}},{key:"sleep",value:function(e){return s.a(this,void 0,void 0,a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=1e3*e,t.abrupt("return",new Promise((function(e){return setTimeout(e,r)})));case 2:case"end":return t.stop()}}),t)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof c.a&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),"undefined"===typeof t&&(t=Object.assign(new f.a,this.options)),t}},{key:"executeWithRetry",value:function(t,r,n){return s.a(this,void 0,void 0,a.a.mark((function i(){var o;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.nextMiddleware.execute(t);case 3:if(!(r<n.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&n.shouldRetry(n.delay,r,t.request,t.options,t.response))){a.next=14;break}return++r,Object(d.e)(t.request,t.options,e.RETRY_ATTEMPT_HEADER,r.toString()),o=this.getDelay(t.response,r,n.delay),a.next=9,this.sleep(o);case 9:return a.next=11,this.executeWithRetry(t,r,n);case 11:return a.abrupt("return",a.sent);case 14:return a.abrupt("return");case 15:a.next=20;break;case 17:throw a.prev=17,a.t0=a.catch(0),a.t0;case 20:case"end":return a.stop()}}),i,this,[[0,17]])})))}},{key:"execute",value:function(e){return s.a(this,void 0,void 0,a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,0,r=this.getOptions(e),h.b.updateFeatureUsageFlag(e,h.a.RETRY_HANDLER_ENABLED),t.next=6,this.executeWithRetry(e,0,r);case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,9]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();l.RETRY_STATUS_CODES=[429,503,504],l.RETRY_ATTEMPT_HEADER="Retry-Attempt",l.RETRY_AFTER_HEADER="Retry-After"},315:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=r(311),c=r(303),d=r(307),f=r(309),h=r(306),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f.a;Object(i.a)(this,e),this.options=t}return Object(o.a)(e,[{key:"isRedirect",value:function(t){return-1!==e.REDIRECT_STATUS_CODES.indexOf(t.status)}},{key:"hasLocationHeader",value:function(t){return t.headers.has(e.LOCATION_HEADER)}},{key:"getLocationHeader",value:function(t){return t.headers.get(e.LOCATION_HEADER)}},{key:"isRelativeURL",value:function(e){return-1===e.indexOf("://")}},{key:"shouldDropAuthorizationHeader",value:function(e,t){var r,n,a=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=a.exec(e);null!==i&&(r=i[0]);var o=a.exec(t);return null!==o&&(n=o[0]),"undefined"!==typeof r&&"undefined"!==typeof n&&r!==n}},{key:"updateRequestUrl",value:function(e,t){return s.a(this,void 0,void 0,a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!==typeof t.request){r.next=4;break}r.t0=e,r.next=7;break;case 4:return r.next=6,Object(d.b)(e,t.request);case 6:r.t0=r.sent;case 7:t.request=r.t0;case 8:case"end":return r.stop()}}),r)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof c.a&&(t=e.middlewareControl.getMiddlewareOptions(f.a)),"undefined"===typeof t&&(t=Object.assign(new f.a,this.options)),t}},{key:"executeWithRedirect",value:function(t,r,n){return s.a(this,void 0,void 0,a.a.mark((function i(){var o,s;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.nextMiddleware.execute(t);case 3:if(o=t.response,!(r<n.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&n.shouldRedirect(o))){a.next=19;break}if(++r,o.status!==e.STATUS_CODE_SEE_OTHER){a.next=11;break}t.options.method=u.a.GET,delete t.options.body,a.next=15;break;case 11:return s=this.getLocationHeader(o),!this.isRelativeURL(s)&&this.shouldDropAuthorizationHeader(o.url,s)&&delete t.options.headers[e.AUTHORIZATION_HEADER],a.next=15,this.updateRequestUrl(s,t);case 15:return a.next=17,this.executeWithRedirect(t,r,n);case 17:a.next=20;break;case 19:return a.abrupt("return");case 20:a.next=25;break;case 22:throw a.prev=22,a.t0=a.catch(0),a.t0;case 25:case"end":return a.stop()}}),i,this,[[0,22]])})))}},{key:"execute",value:function(t){return s.a(this,void 0,void 0,a.a.mark((function r(){var n;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,0,n=this.getOptions(t),t.options.redirect=e.MANUAL_REDIRECT,h.b.updateFeatureUsageFlag(t,h.a.REDIRECT_HANDLER_ENABLED),r.next=7,this.executeWithRedirect(t,0,n);case 7:return r.abrupt("return",r.sent);case 10:throw r.prev=10,r.t0=r.catch(0),r.t0;case 13:case"end":return r.stop()}}),r,this,[[0,10]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();l.REDIRECT_STATUS_CODES=[301,302,303,307,308],l.STATUS_CODE_SEE_OTHER=303,l.LOCATION_HEADER="Location",l.AUTHORIZATION_HEADER="Authorization",l.MANUAL_REDIRECT="manual"},316:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=r(329),c=r(303),d=r(307),f=r(306),h=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"execute",value:function(t){return s.a(this,void 0,void 0,a.a.mark((function r(){var n,i,o,s,h;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n="string"===typeof t.request?t.request:t.request.url,Object(u.a)(n)?((i=Object(d.d)(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER))||(i=Object(d.c)(),Object(d.e)(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER,i)),o="".concat(e.PRODUCT_NAME,"/").concat("2.2.1"),t.middlewareControl instanceof c.a&&(s=t.middlewareControl.getMiddlewareOptions(f.b)),s&&(h=s.getFeatureUsage(),o+=" (".concat(e.FEATURE_USAGE_STRING,"=").concat(h,")")),Object(d.a)(t.request,t.options,e.SDK_VERSION_HEADER,o)):(delete t.options.headers[e.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[e.SDK_VERSION_HEADER]),r.next=5,this.nextMiddleware.execute(t);case 5:return r.abrupt("return",r.sent);case 8:throw r.prev=8,r.t0=r.catch(0),r.t0;case 11:case"end":return r.stop()}}),r,this,[[0,8]])})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();h.CLIENT_REQUEST_ID_HEADER="client-request-id",h.SDK_VERSION_HEADER="SdkVersion",h.PRODUCT_NAME="graph-js",h.FEATURE_USAGE_STRING="featureUsage"},319:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(109);function a(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=Object(n.a)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}},320:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(25),a=function e(t,r){Object(n.a)(this,e),this.authenticationProvider=t,this.authenticationProviderOptions=r}},322:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Object(i.a)(this,e),this.minValue=t,this.maxValue=r},c=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(i.a)(this,e),this.DEFAULT_FILE_SIZE=5242880,this.client=t,this.file=r,void 0===a.rangeSize&&(a.rangeSize=this.DEFAULT_FILE_SIZE),this.options=a,this.uploadSession=n,this.nextRange=new u(0,this.options.rangeSize-1)}return Object(o.a)(e,[{key:"parseRange",value:function(e){var t=e[0];if("undefined"===typeof t||""===t)return new u;var r=t.split("-"),n=parseInt(r[0],10),a=parseInt(r[1],10);return Number.isNaN(a)&&(a=this.file.size-1),new u(n,a)}},{key:"updateTaskStatus",value:function(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}},{key:"getNextRange",value:function(){if(-1===this.nextRange.minValue)return this.nextRange;var e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new u(e,t)}},{key:"sliceFile",value:function(e){return this.file.content.slice(e.minValue,e.maxValue+1)}},{key:"upload",value:function(){return s.a(this,void 0,void 0,a.a.mark((function e(){var t,r,n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;case 1:if(-1!==(t=this.getNextRange()).maxValue){e.next=7;break}throw(r=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file")).name="Invalid Session",r;case 7:return n=this.sliceFile(t),e.next=10,this.uploadSlice(n,t,this.file.size);case 10:if(void 0===(i=e.sent).id){e.next=15;break}return e.abrupt("return",i);case 15:this.updateTaskStatus(i);case 16:e.next=1;break;case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(0),e.t0;case 23:case"end":return e.stop()}}),e,this,[[0,20]])})))}},{key:"uploadSlice",value:function(e,t,r){return s.a(this,void 0,void 0,a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(r)}).put(e);case 3:return n.abrupt("return",n.sent);case 6:throw n.prev=6,n.t0=n.catch(0),n.t0;case 9:case"end":return n.stop()}}),n,this,[[0,6]])})))}},{key:"cancel",value:function(){return s.a(this,void 0,void 0,a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api(this.uploadSession.url).delete();case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"getStatus",value:function(){return s.a(this,void 0,void 0,a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.client.api(this.uploadSession.url).get();case 3:return t=e.sent,this.updateTaskStatus(t),e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))}},{key:"resume",value:function(){return s.a(this,void 0,void 0,a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getStatus();case 3:return e.next=5,this.upload();case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(0),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))}}],[{key:"createUploadSession",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s.a(this,void 0,void 0,a.a.mark((function i(){var o,s;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api(t).headers(n).post(r);case 3:return o=a.sent,s={url:o.uploadUrl,expiry:new Date(o.expirationDateTime)},a.abrupt("return",s);case 8:throw a.prev=8,a.t0=a.catch(0),a.t0;case 11:case"end":return a.stop()}}),i,null,[[0,8]])})))}}]),e}()},324:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.useAsyncMemo=function(e,t,r){void 0===r&&(r=void 0);var a=n.useState(r),i=a[0],o=a[1];return n.useEffect((function(){var t=!1,r=e();if(void 0!==r&&null!==r)return r.then((function(e){t||o(e)})),function(){t=!0}}),t),i}},328:function(e,t,r){"use strict";(function(e){var t=r(2),n=r.n(t),a=r(319),i=r(25),o=r(102),s=r(296),u=r(311);(function(){function t(e){if(Object(i.a)(this,t),this.requests=new Map,"undefined"!==typeof e){var r=t.requestLimit;if(e.length>r){var n=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw n.name="Limit Exceeded Error",n}var o,s=Object(a.a)(e);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.addRequest(u)}}catch(c){s.e(c)}finally{s.f()}}}return Object(o.a)(t,[{key:"addRequest",value:function(e){var r=t.requestLimit;if(""===e.id){var n=new Error("Id for a request is empty, Please provide an unique id");throw n.name="Empty Id For Request",n}if(this.requests.size===r){var a=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw a.name="Limit Exceeded Error",a}if(this.requests.has(e.id)){var i=new Error("Adding request with duplicate id ".concat(e.id,", Make the id of the requests unique"));throw i.name="Duplicate RequestId Error",i}return this.requests.set(e.id,e),e.id}},{key:"removeRequest",value:function(e){for(var t=this.requests.delete(e),r=this.requests.entries(),n=r.next();!n.done;){var a=n.value[1].dependsOn;if("undefined"!==typeof a){var i=a.indexOf(e);-1!==i&&a.splice(i,1),0===a.length&&delete n.value[1].dependsOn}n=r.next()}return t}},{key:"getContent",value:function(){return s.a(this,void 0,void 0,n.a.mark((function e(){var r,a,i,o,s,u,c,d,f;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={requests:r=[]},i=this.requests.entries(),!(o=i.next()).done){e.next=8;break}throw(s=new Error("No requests added yet, Please add at least one request.")).name="Empty Payload",s;case 8:if(t.validateDependencies(this.requests)){e.next=12;break}throw(u=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.")).name="Invalid Dependency",u;case 12:if(o.done){e.next=27;break}return c=o.value[1],e.next=16,t.getRequestData(c.request);case 16:if(void 0===(d=e.sent).body||void 0!==d.headers&&void 0!==d.headers["content-type"]){e.next=21;break}throw(f=new Error("Content-type header is not mentioned for request #".concat(c.id,", For request having body, Content-type header should be mentioned"))).name="Invalid Content-type header",f;case 21:d.id=c.id,void 0!==c.dependsOn&&c.dependsOn.length>0&&(d.dependsOn=c.dependsOn),r.push(d),o=i.next(),e.next=12;break;case 27:return a.requests=r,e.abrupt("return",a);case 29:case"end":return e.stop()}}),e,this)})))}},{key:"addDependency",value:function(e,t){if(!this.requests.has(e)){var r=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw r.name="Invalid Dependent",r}if("undefined"!==typeof t&&!this.requests.has(t)){var n=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw n.name="Invalid Dependency",n}if("undefined"!==typeof t){var a=this.requests.get(e);if(void 0===a.dependsOn&&(a.dependsOn=[]),-1!==a.dependsOn.indexOf(t)){var i=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw i.name="Duplicate Dependency",i}a.dependsOn.push(t)}else{for(var o,s=this.requests.entries(),u=s.next();!u.done&&u.value[1].id!==e;)o=u,u=s.next();if("undefined"===typeof o){var c=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw c.name="Invalid Dependency Addition",c}var d=o.value[0];if(void 0===u.value[1].dependsOn&&(u.value[1].dependsOn=[]),-1!==u.value[1].dependsOn.indexOf(d)){var f=new Error("Dependency ".concat(d," is already added for the request ").concat(e));throw f.name="Duplicate Dependency",f}u.value[1].dependsOn.push(d)}}},{key:"removeDependency",value:function(e,t){var r=this.requests.get(e);if("undefined"===typeof r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if("undefined"!==typeof t){var n=r.dependsOn.indexOf(t);return-1!==n&&(r.dependsOn.splice(n,1),!0)}return delete r.dependsOn,!0}}],[{key:"validateDependencies",value:function(e){if(0===e.size){var t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return function(e){for(var t=e.entries(),r=t.next();!r.done;){var n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;r=t.next()}return!0}(e)||function(e){var t=e.entries(),r=t.next(),n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;var a=r;for(r=t.next();!r.done;){var i=r.value[1];if(void 0===i.dependsOn||1!==i.dependsOn.length||i.dependsOn[0]!==a.value[1].id)return!1;a=r,r=t.next()}return!0}(e)||function(e){var t,r=e.entries(),n=r.next(),a=n.value[1];if(void 0===a.dependsOn||0===a.dependsOn.length)t=a.id;else{if(1!==a.dependsOn.length)return!1;var i=a.dependsOn[0];if(i===a.id||!e.has(i))return!1;t=i}for(n=r.next();!n.done;){var o=n.value[1];if((void 0===o.dependsOn||0===o.dependsOn.length)&&t!==o.id)return!1;if(void 0!==o.dependsOn&&0!==o.dependsOn.length){if(1===o.dependsOn.length&&(o.id===t||o.dependsOn[0]!==t))return!1;if(o.dependsOn.length>1)return!1}n=r.next()}return!0}(e)}},{key:"getRequestData",value:function(e){return s.a(this,void 0,void 0,n.a.mark((function r(){var a,i,o;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a={url:""},i=new RegExp("^https?://"),a.url=i.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,a.method=e.method,o={},e.headers.forEach((function(e,t){o[t]=e})),Object.keys(o).length&&(a.headers=o),e.method!==u.a.PATCH&&e.method!==u.a.POST&&e.method!==u.a.PUT){r.next=11;break}return r.next=10,t.getRequestBody(e);case 10:a.body=r.sent;case 11:return r.abrupt("return",a);case 12:case"end":return r.stop()}}),r)})))}},{key:"getRequestBody",value:function(t){return s.a(this,void 0,void 0,n.a.mark((function r(){var a,i,o,s,u,c;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=!1,r.prev=1,o=t.clone(),r.next=5,o.json();case 5:i=r.sent,a=!0,r.next=11;break;case 9:r.prev=9,r.t0=r.catch(1);case 11:if(a){r.next=33;break}if(r.prev=12,"undefined"===typeof Blob){r.next=23;break}return r.next=16,t.blob();case 16:return s=r.sent,u=new FileReader,r.next=20,new Promise((function(e){u.addEventListener("load",(function(){var t=u.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),u.readAsDataURL(s)}));case 20:i=r.sent,r.next=28;break;case 23:if("undefined"===typeof e){r.next=28;break}return r.next=26,t.buffer();case 26:c=r.sent,i=c.toString("base64");case 28:a=!0,r.next=33;break;case 31:r.prev=31,r.t1=r.catch(12);case 33:return r.abrupt("return",i);case 34:case"end":return r.stop()}}),r,null,[[1,9],[12,31]])})))}}]),t}()).requestLimit=20}).call(this,r(8).Buffer)},329:function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r(330),a=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],i=function(e){var t=function(e){return e.replace(/^\/+/,"")};return Array.prototype.slice.call(e).reduce((function(e,r){return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n}))},o=function(t){var r=t&&t.constructor&&t.constructor.name;if("Buffer"===r||"Blob"===r||"File"===r||"FormData"===r||"string"===typeof t)return t;if("ArrayBuffer"===r)t=e.from(t);else if("Int8Array"===r||"Int16Array"===r||"Int32Array"===r||"Uint8Array"===r||"Uint16Array"===r||"Uint32Array"===r||"Uint8ClampedArray"===r||"Float32Array"===r||"Float64Array"===r||"DataView"===r)t=e.from(t.buffer);else try{t=JSON.stringify(t)}catch(n){throw new Error("Unable to stringify the content")}return t},s=function(e){if(-1!==(e=e.toLowerCase()).indexOf("https://")){var t=(e=e.replace("https://","")).indexOf(":"),r=e.indexOf("/"),a="";if(-1!==r)return-1!==t&&t<r?(a=e.substring(0,t),n.c.has(a)):(a=e.substring(0,r),n.c.has(a))}return!1}}).call(this,r(8).Buffer)},330:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i}));var n="v1.0",a="https://graph.microsoft.com/",i=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"])},331:function(e,t,r){"use strict";(function(e){r(25),r(102),r(312),r(313),r(309),r(308),r(315),r(314),r(316)}).call(this,r(4))},332:function(e,t,r){"use strict";(function(e){var t=r(2),n=r.n(t),a=r(25),i=r(102),o=r(385),s=r(60),u=r(41),c=r(42),d=r(296),f=r(322),h=r(348);(function(t){Object(u.a)(f,t);var r=Object(c.a)(f);function f(e,t,n,i){return Object(a.a)(this,f),r.call(this,e,t,n,i)}return Object(i.a)(f,[{key:"commit",value:function(e){return d.a(this,void 0,void 0,n.a.mark((function t(){var r;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url},t.next=4,this.client.api(e).put(r);case 4:return t.abrupt("return",t.sent);case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}}],[{key:"constructCreateSessionUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.DEFAULT_UPLOAD_PATH;return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t="/".concat(t)),"/"!==t[t.length-1]&&(t="".concat(t,"/")),"/me/drive/root:".concat(t.split("/").map((function(e){return encodeURIComponent(e)})).join("/")).concat(encodeURIComponent(e),":/createUploadSession")}},{key:"create",value:function(t,r,a){return d.a(this,void 0,void 0,n.a.mark((function i(){var o,s,u,c,d,l,p,v;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=a.fileName,"undefined"!==typeof Blob&&r instanceof Blob?(s=new File([r],o),u=s.size):"undefined"!==typeof File&&r instanceof File?u=(s=r).size:"undefined"!==typeof e&&r instanceof e&&(u=(c=r).byteLength-c.byteOffset,s=c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)),n.prev=2,d=f.constructCreateSessionUrl(a.fileName,a.path),n.next=6,f.createUploadSession(t,d,a.fileName);case 6:return l=n.sent,p=Object(h.a)(a.rangeSize),v={name:o,content:s,size:u},n.abrupt("return",new f(t,v,l,{rangeSize:p}));case 12:throw n.prev=12,n.t0=n.catch(2),n.t0;case 15:case"end":return n.stop()}}),i,null,[[2,12]])})))}},{key:"createUploadSession",value:function(e,t,r){var a=this,i=Object.create(null,{createUploadSession:{get:function(){return Object(o.a)(Object(s.a)(f),"createUploadSession",a)}}});return d.a(this,void 0,void 0,n.a.mark((function a(){var o;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o={item:{"@microsoft.graph.conflictBehavior":"rename",name:r}},n.prev=1,n.abrupt("return",i.createUploadSession.call(this,e,t,o));case 5:throw n.prev=5,n.t0=n.catch(1),n.t0;case 8:case"end":return n.stop()}}),a,this,[[1,5]])})))}}]),f}(f.a)).DEFAULT_UPLOAD_PATH="/"}).call(this,r(8).Buffer)},333:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(2),a=r.n(n),i=r(25),o=r(102),s=r(296),u=function(){function e(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(Object(i.a)(this,e),!r||!r.length){var a=new Error;throw a.name="InvalidMiddlewareChain",a.message="Please provide a default middleware chain or custom middleware chain",a}this.setMiddleware.apply(this,r)}return Object(o.a)(e,[{key:"setMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}},{key:"parseMiddleWareArray",value:function(e){e.forEach((function(t,r){r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}},{key:"sendRequest",value:function(e){return s.a(this,void 0,void 0,a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"string"!==typeof e.request||void 0!==e.options){t.next=6;break}throw(r=new Error).name="InvalidRequestOptions",r.message="Unable to execute the middleware, Please provide valid options for a request",r;case 6:return t.next=8,this.middleware.execute(e);case 8:return t.abrupt("return",e);case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[0,11]])})))}}]),e}()},348:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=5242880,a=function(e){return e>327680&&(e=320*Math.floor(e/327680)*1024),e},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,t=62914560;return e>t&&(e=t),a(e)}},349:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return p}));var n=r(106),a=r(25),i=r(102),o=r(333),s=r(312),u=r(313),c=r(309),d=r(308),f=r(315),h=r(314),l=r(316),p=function(){function t(){Object(a.a)(this,t)}return Object(i.a)(t,null,[{key:"createWithAuthenticationProvider",value:function(r){var n=new s.a(r),a=new h.a(new d.a),i=new l.a,o=new u.a;if(n.setNext(a),"object"===typeof e){var p=new f.a(new c.a);a.setNext(p),p.setNext(i)}else a.setNext(i);return i.setNext(o),t.createWithMiddleware(n)}},{key:"createWithMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(n.a)(o.a,t)}}]),t}()}).call(this,r(4))},383:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));r(328);var n,a=r(2),i=r.n(a),o=r(25),s=r(102);r(312),r(313),r(314),r(315),r(316),r(331),r(320),r(308),r(309),r(306);!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(n||(n={}));var u,c,d,f,h=r(296),l=r(303),p=(r(307),r(322),r(332),r(106)),v=r(111),y=r(330),m=function(){function e(t){Object(o.a)(this,e),this.provider=t}return Object(s.a)(e,[{key:"getAccessToken",value:function(){return h.a(this,void 0,void 0,i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.provider((function(t,n){n?e(n):r(t)}))})));case 1:case"end":return e.stop()}}),e)})))}}]),e}(),b=r(319),w=r(29),E=r(41),x=r(42),O=r(43),g=function(e){Object(E.a)(r,e);var t=Object(x.a)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return Object(o.a)(this,r),e=t.call(this,a||i&&i.message),Object.setPrototypeOf(Object(w.a)(e),r.prototype),e.statusCode=n,e.code=null,e.requestId=null,e.date=new Date,e.body=null,e.stack=i?i.stack:e.stack,e}return r}(Object(O.a)(Error)),k=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"constructError",value:function(e,t){var r=new g(t,"",e);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.date=new Date,r}},{key:"constructErrorFromResponse",value:function(e,t){e=e.error;var r=new g(t,e.message);r.code=e.code,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}},{key:"getError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0;return h.a(this,void 0,void 0,i.a.mark((function a(){var o;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=t&&t.error?e.constructErrorFromResponse(t,r):"undefined"!==typeof Error&&t instanceof Error?e.constructError(t,r):new g(r),"function"!==typeof n){a.next=5;break}n(o,null),a.next=6;break;case 5:return a.abrupt("return",o);case 6:case"end":return a.stop()}}),a)})))}}]),e}(),R=r(329);!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(u||(u={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(c||(c={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(d||(d={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(f||(f={}));var A=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"parseDocumentResponse",value:function(e,t){try{return"undefined"!==typeof DOMParser?new Promise((function(r,n){e.text().then((function(e){try{var a=(new DOMParser).parseFromString(e,t);r(a)}catch(i){n(i)}}))})):Promise.resolve(e.body)}catch(r){throw r}}},{key:"convertResponse",value:function(t,r){return h.a(this,void 0,void 0,i.a.mark((function n(){var a,o,s;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(204!==t.status){n.next=2;break}return n.abrupt("return",Promise.resolve());case 2:n.prev=2,n.t0=r,n.next=n.t0===u.ARRAYBUFFER?6:n.t0===u.BLOB?10:n.t0===u.DOCUMENT?14:n.t0===u.JSON?18:n.t0===u.STREAM?22:n.t0===u.TEXT?26:30;break;case 6:return n.next=8,t.arrayBuffer();case 8:return a=n.sent,n.abrupt("break",60);case 10:return n.next=12,t.blob();case 12:return a=n.sent,n.abrupt("break",60);case 14:return n.next=16,e.parseDocumentResponse(t,c.TEXT_XML);case 16:return a=n.sent,n.abrupt("break",60);case 18:return n.next=20,t.json();case 20:return a=n.sent,n.abrupt("break",60);case 22:return n.next=24,Promise.resolve(t.body);case 24:return a=n.sent,n.abrupt("break",60);case 26:return n.next=28,t.text();case 28:return a=n.sent,n.abrupt("break",60);case 30:if(null===(o=t.headers.get("Content-type"))){n.next=58;break}if(s=o.split(";")[0],!new RegExp(f.DOCUMENT).test(s)){n.next=39;break}return n.next=36,e.parseDocumentResponse(t,s);case 36:a=n.sent,n.next=56;break;case 39:if(!new RegExp(f.IMAGE).test(s)){n.next=43;break}a=t.blob(),n.next=56;break;case 43:if(s!==d.TEXT_PLAIN){n.next=49;break}return n.next=46,t.text();case 46:a=n.sent,n.next=56;break;case 49:if(s!==d.APPLICATION_JSON){n.next=55;break}return n.next=52,t.json();case 52:a=n.sent,n.next=56;break;case 55:a=Promise.resolve(t.body);case 56:n.next=59;break;case 58:a=Promise.resolve(t.body);case 59:return n.abrupt("break",60);case 60:n.next=65;break;case 62:throw n.prev=62,n.t1=n.catch(2),n.t1;case 65:return n.abrupt("return",a);case 66:case"end":return n.stop()}}),n,null,[[2,62]])})))}},{key:"getResponse",value:function(t,r,n){return h.a(this,void 0,void 0,i.a.mark((function a(){var o;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r!==u.RAW){a.next=5;break}return a.abrupt("return",Promise.resolve(t));case 5:return a.next=7,e.convertResponse(t,r);case 7:if(o=a.sent,!t.ok){a.next=16;break}if("function"!==typeof n){a.next=13;break}n(null,o),a.next=14;break;case 13:return a.abrupt("return",o);case 14:a.next=17;break;case 16:throw o;case 17:a.next=22;break;case 19:throw a.prev=19,a.t0=a.catch(0),a.t0;case 22:case"end":return a.stop()}}),a,null,[[0,19]])})))}}]),e}(),T=r(311),D=function(){function e(t,r,n){var a=this;Object(o.a)(this,e),this.parsePath=function(e){if(-1!==e.indexOf("https://")){var t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(a.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));var r=e.indexOf("/");-1!==r&&(a.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));var n=e.indexOf("?");if(-1===n)a.urlComponents.path=e;else{a.urlComponents.path=e.substr(0,n);var i,o=e.substring(n+1,e.length).split("&"),s=Object(b.a)(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;a.parseQueryParameter(u)}}catch(c){s.e(c)}finally{s.f()}}},this.httpClient=t,this.config=r,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}return Object(s.a)(e,[{key:"addCsvQueryParameter",value:function(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";var n=[];r.length>1&&"string"===typeof t?n=Array.prototype.slice.call(r):"string"===typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}},{key:"buildFullUrl",value:function(){var e=Object(R.d)([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}},{key:"createQueryString",value:function(){var e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(var r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(var n in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length){var a,i=Object(b.a)(e.otherURLQueryOptions);try{for(i.s();!(a=i.n()).done;){var o=a.value;t.push(o)}}catch(s){i.e(s)}finally{i.f()}}return t.length>0?"?"+t.join("&"):""}},{key:"parseQueryParameter",value:function(e){if("string"===typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){var t,r=e.split("&"),n=Object(b.a)(r);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.parseQueryParamenterString(a)}}catch(o){n.e(o)}finally{n.f()}}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(var i in e)e.hasOwnProperty(i)&&this.setURLComponentsQueryParamater(i,e[i]);return this}},{key:"parseQueryParamenterString",value:function(e){if(this.isValidQueryKeyValuePair(e)){var t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}},{key:"setURLComponentsQueryParamater",value:function(e,t){if(-1!==R.b.indexOf(e)){var r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}},{key:"isValidQueryKeyValuePair",value:function(e){var t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}},{key:"updateRequestOptions",value:function(e){var t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){var r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}},{key:"send",value:function(e,t,r){return h.a(this,void 0,void 0,i.a.mark((function n(){var a,o,s,u,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=new l.a(this._middlewareOptions),this.updateRequestOptions(t),n.prev=2,n.next=5,this.httpClient.sendRequest({request:e,options:t,middlewareControl:o});case 5:return s=n.sent,a=s.response,n.next=9,A.getResponse(a,this._responseType,r);case 9:return u=n.sent,n.abrupt("return",u);case 13:return n.prev=13,n.t0=n.catch(2),"undefined"!==typeof a&&(c=a.status),n.next=18,k.getError(n.t0,c,r);case 18:throw n.sent;case 20:case"end":return n.stop()}}),n,this,[[2,13]])})))}},{key:"setHeaderContentType",value:function(){if(this._headers){for(var e=0,t=Object.keys(this._headers);e<t.length;e++){if("content-type"===t[e].toLowerCase())return}this.header("Content-Type","application/json")}else this.header("Content-Type","application/json")}},{key:"header",value:function(e,t){return this._headers[e]=t,this}},{key:"headers",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}},{key:"option",value:function(e,t){return this._options[e]=t,this}},{key:"options",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}},{key:"middlewareOptions",value:function(e){return this._middlewareOptions=e,this}},{key:"version",value:function(e){return this.urlComponents.version=e,this}},{key:"responseType",value:function(e){return this._responseType=e,this}},{key:"select",value:function(e){return this.addCsvQueryParameter("$select",e,arguments),this}},{key:"expand",value:function(e){return this.addCsvQueryParameter("$expand",e,arguments),this}},{key:"orderby",value:function(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}},{key:"filter",value:function(e){return this.urlComponents.oDataQueryParams.$filter=e,this}},{key:"search",value:function(e){return this.urlComponents.oDataQueryParams.$search=e,this}},{key:"top",value:function(e){return this.urlComponents.oDataQueryParams.$top=e,this}},{key:"skip",value:function(e){return this.urlComponents.oDataQueryParams.$skip=e,this}},{key:"skipToken",value:function(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}},{key:"count",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.urlComponents.oDataQueryParams.$count=e.toString(),this}},{key:"query",value:function(e){return this.parseQueryParameter(e)}},{key:"get",value:function(e){return h.a(this,void 0,void 0,i.a.mark((function t(){var r,n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:T.a.GET},t.prev=2,t.next=5,this.send(r,n,e);case 5:return a=t.sent,t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"post",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){var n,a,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:T.a.POST,body:Object(R.c)(e)},"FormData"===(e&&e.constructor&&e.constructor.name)?a.headers={}:(this.setHeaderContentType(),a.headers=this._headers),r.prev=4,r.next=7,this.send(n,a,t);case 7:return o=r.sent,r.abrupt("return",o);case 11:throw r.prev=11,r.t0=r.catch(4),r.t0;case 14:case"end":return r.stop()}}),r,this,[[4,11]])})))}},{key:"create",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.post(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}}),r,this,[[0,6]])})))}},{key:"put",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){var n,a,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),this.setHeaderContentType(),a={method:T.a.PUT,body:Object(R.c)(e)},r.prev=3,r.next=6,this.send(n,a,t);case 6:return o=r.sent,r.abrupt("return",o);case 10:throw r.prev=10,r.t0=r.catch(3),r.t0;case 13:case"end":return r.stop()}}),r,this,[[3,10]])})))}},{key:"patch",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){var n,a,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),this.setHeaderContentType(),a={method:T.a.PATCH,body:Object(R.c)(e)},r.prev=3,r.next=6,this.send(n,a,t);case 6:return o=r.sent,r.abrupt("return",o);case 10:throw r.prev=10,r.t0=r.catch(3),r.t0;case 13:case"end":return r.stop()}}),r,this,[[3,10]])})))}},{key:"update",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.patch(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}}),r,this,[[0,6]])})))}},{key:"delete",value:function(e){return h.a(this,void 0,void 0,i.a.mark((function t(){var r,n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:T.a.DELETE},t.prev=2,t.next=5,this.send(r,n,e);case 5:return a=t.sent,t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"del",value:function(e){return h.a(this,void 0,void 0,i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.delete(e);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"getStream",value:function(e){return h.a(this,void 0,void 0,i.a.mark((function t(){var r,n,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:T.a.GET},this.responseType(u.STREAM),t.prev=3,t.next=6,this.send(r,n,e);case 6:return a=t.sent,t.abrupt("return",a);case 10:throw t.prev=10,t.t0=t.catch(3),t.t0;case 13:case"end":return t.stop()}}),t,this,[[3,10]])})))}},{key:"putStream",value:function(e,t){return h.a(this,void 0,void 0,i.a.mark((function r(){var n,a,o;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:T.a.PUT,headers:{"Content-Type":"application/octet-stream"},body:e},r.prev=2,r.next=5,this.send(n,a,t);case 5:return o=r.sent,r.abrupt("return",o);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}}),r,this,[[2,9]])})))}}]),e}(),_=r(333),P=r(349),S=function(){function e(t){Object(o.a)(this,e),this.config={baseUrl:y.b,debugLogging:!1,defaultVersion:y.a};try{!function(){if("undefined"===typeof Promise&&"undefined"===typeof fetch){var e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"===typeof Promise){var t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"===typeof fetch){var r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}}()}catch(a){throw a}for(var r in t)t.hasOwnProperty(r)&&(this.config[r]=t[r]);var n;if(void 0!==t.authProvider&&void 0!==t.middleware){var a=new Error;throw a.name="AmbiguityInInitialization",a.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",a}if(void 0!==t.authProvider)n=P.a.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){var i=new Error;throw i.name="InvalidMiddlewareChain",i.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",i}n=Object(p.a)(_.a,Object(v.a)([].concat(t.middleware)))}this.httpClient=n}return Object(s.a)(e,[{key:"api",value:function(e){return new D(this.httpClient,this.config,e)}}],[{key:"init",value:function(t){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]="authProvider"===n?new m(t[n]):t[n]);return e.initWithMiddleware(r)}},{key:"initWithMiddleware",value:function(t){try{return new e(t)}catch(r){throw r}}}]),e}(),U=function(e,t){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function C(e,t){function r(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var j={code:"unexpected_error",desc:"Unexpected error in authentication."},M={code:"no_window_object",desc:"No window object available. Details:"},L=function(e){function t(r,n){var a=e.call(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a.errorCode=r,a.errorMessage=n,a.name="AuthError",a}return C(t,e),t.createUnexpectedError=function(e){return new t(j.code,j.desc+": "+e)},t.createNoWindowObjectError=function(e){return new t(M.code,M.desc+" "+e)},t}(Error),N={code:"server_unavailable",desc:"Server is temporarily unavailable."},I={code:"unknown_server_error"},q=function(e){function t(r,n){var a=e.call(this,r,n)||this;return a.name="ServerError",Object.setPrototypeOf(a,t.prototype),a}return C(t,e),t.createServerUnavailableError=function(){return new t(N.code,N.desc)},t.createUnknownServerError=function(e){return new t(I.code,e)},t}(L),H={code:"interaction_required"},F={code:"consent_required"},Q={code:"login_required"};!function(e){function t(r,n){var a=e.call(this,r,n)||this;return a.name="InteractionRequiredAuthError",Object.setPrototypeOf(a,t.prototype),a}C(t,e),t.isInteractionRequiredError=function(e){var t=[H.code,F.code,Q.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(Q.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(H.code,e)},t.createConsentRequiredAuthError=function(e){return new t(F.code,e)}}(q)},385:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(60);function a(e,t,r){return(a="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(n.a)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}}}]);
//# sourceMappingURL=0.33e9e640.chunk.js.map